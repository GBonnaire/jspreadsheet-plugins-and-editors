/**
 * Plugin for auto width cols
 *
 * @version 2.2.1
 * @author Guillaume Bonnaire <contact@gbonnaire.fr>
 * @website https://repo.gbonnaire.fr
 * @description auto size width of columns
 * - autosize all columns without width property
 *
 * @license This plugin is distribute under MIT License
 */
var jspreadsheet;jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_autoWidth=t()}(this,function(){return function(e,t,n){if(parseInt(jspreadsheet.version().version.split(".")[0])<8)return console.error('Plugin "auto Width" not compatible with jspreadsheet '+jspreadsheet.version().version+", Please use an older version of this plugin compatible. Go to https://github.com/GBonnaire/jspreadsheet-plugins-and-editors/"),{};const r={};r.options=Object.assign({},t);let o="",a=[],i={};var s,l={fullsizeTable:!1,parseAllData:!0};for(s in null==r.options&&(r.options={}),l)r.options.hasOwnProperty(s)&&null!=r.options[s]||(r.options[s]=l[s]);r.onevent=function(e,t){"onresizecolumn"===e&&(r.beforeinit(t),u(t))},r.beforeinit=function(t){a=[];for(let e=0;e<t.options.columns.length;e++){var n=t.options.columns[e];null!=n.width&&""!==n.width&&"auto"!==n.width||(a.push(e),t.options.columns[e].width=100)}},r.init=function(e){u(e)};const u=function(e){d(e),p(e);var t=h(e);f(e),c(t,e)},d=function(e){o=e.table.style.cssText},p=function(e){e.table.style.tableLayout="auto"},f=function(e){e.table.style.cssText=o},h=function(s){const e=[];if(0===s.rows.length)return e;var t=s.rows[0].element;if(t)for(let i=0;i<t.children.length;i++)if(0!==i){let o=t.children[i].offsetWidth;if(r.options.parseAllData){let n=t.children[0].innerText.length;var l=o;for(let t=0;t<s.rows.length;t++){let e=s.getValueFromCoords(i-1,t,!0);"string"!=typeof e&&(e=null===e?"":""+e),null==s.rows[t].element?o=Math.max(Math.ceil(e.length/n*l),o):n=Math.max(e.length,n)}}e.push(o)}return e},c=function(n,o){var e=o.options.editable;o.options.editable=!0,g(o.parent),null==o.options.defaultColWidth||""===o.options.defaultColWidth||"auto"===o.options.defaultColWidth?o.options.defaultColWidth=50:"string"==typeof o.options.defaultColWidth&&(o.options.defaultColWidth=parseInt(o.options.defaultColWidth));let i=0,s=0;if(r.options.fullsizeTable){i=o.table.parentNode.parentNode.offsetWidth-26,o.table.classList.contains("jss_hidden_index")||(i-=50),s=n.reduce(function(e,t,n){return-1<a.indexOf(n)?1===n&&-1===a.indexOf(0)?t:e+t:1===n&&-1===a.indexOf(0)?0:e});for(let e=0;e<o.options.columns.length;e++){var t=o.options.columns[e];"hidden"!==t.type&&(-1===a.indexOf(e)?i=Math.max(0,i-parseFloat(t.width)):n[e]<100&&(s=Math.max(0,s+(100-n[e]))))}}i-=7;for(let t=0;t<o.options.columns.length;t++){var l=o.options.columns[t];let e;"hidden"!==l.type&&-1<a.indexOf(t)&&(e=n[t]?Math.max(o.options.defaultColWidth,n[t]):o.options.defaultColWidth,r.options.fullsizeTable&&s<i&&(e=e/s*i),o.setWidth(t,e))}m(o.parent),o.options.editable=e},g=function(e){null==i.ignoreEvents&&(i.ignoreEvents=e.ignoreEvents),e.ignoreEvents=!0,null==i.ignoreCloud&&(i.ignoreCloud=e.ignoreCloud),null==i.ignoreHistory&&(i.ignoreHistory=e.ignoreHistory),e.ignoreHistory=!0,null==i.ignorePersistence&&(i.ignorePersistence=e.ignorePersistence),e.ignorePersistence=!0},m=function(e){e.ignoreEvents=i.ignoreEvents,e.ignoreHistory=i.ignoreHistory,e.ignorePersistence=i.ignorePersistence,i={}};return r}});
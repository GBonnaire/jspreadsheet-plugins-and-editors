var jspreadsheet;jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_autoWidth=t()}(this,function(){return function(e,t,n){if(parseInt(jspreadsheet.version().version.split(".")[0])<8)return console.error('Plugin "auto Width" not compatible with jspreadsheet '+jspreadsheet.version().version+", Please use an older version of this plugin compatible. Go to https://github.com/GBonnaire/jspreadsheet-plugins-and-editors/"),{};const a={};a.options=Object.assign({},t);let o="",l=[],i={};var s,r={fullsizeTable:!1,parseAllData:!0};for(s in null==a.options&&(a.options={}),r)a.options.hasOwnProperty(s)&&null!=a.options[s]||(a.options[s]=r[s]);a.onevent=function(e,t){"onresizecolumn"===e&&(a.beforeinit(t),u(t))},a.beforeinit=function(t){l=[];for(let e=0;e<t.options.columns.length;e++){var n=t.options.columns[e];null!=n.width&&""!==n.width&&"auto"!==n.width||(l.push(e),t.options.columns[e].width=100)}},a.init=function(e){u(e)};const u=function(e){d(e),p(e);var t=h(e);f(e),c(t,e)},d=function(e){o=e.table.style.cssText},p=function(e){e.table.style.tableLayout="auto"},f=function(e){e.table.style.cssText=o},h=function(i){const e=[];if(0===i.rows.length)return e;var s=i.rows[0].element;if(s)for(let o=0;o<s.children.length;o++)if(0!==o){let n=s.children[o].offsetWidth;if(a.options.parseAllData){let t=s.children[0].innerText.length;var r=n;for(let e=0;e<i.rows.length;e++){var l=i.getValueFromCoords(o-1,e,!0);null==i.rows[e].element?n=Math.max(Math.ceil(l.length/t*r),n):t=Math.max(l.length,t)}}e.push(n)}return e},c=function(n,o){var e=o.options.editable;o.options.editable=!0,g(o.parent),null==o.options.defaultColWidth||""===o.options.defaultColWidth||"auto"===o.options.defaultColWidth?o.options.defaultColWidth=50:"string"==typeof o.options.defaultColWidth&&(o.options.defaultColWidth=parseInt(o.options.defaultColWidth));let i=0,s=0;if(a.options.fullsizeTable){i=o.table.parentNode.parentNode.offsetWidth-26,o.table.classList.contains("jss_hidden_index")||(i-=50),s=n.reduce(function(e,t,n){return-1<l.indexOf(n)?1===n&&-1===l.indexOf(0)?t:e+t:1===n&&-1===l.indexOf(0)?0:e});for(let e=0;e<o.options.columns.length;e++){var t=o.options.columns[e];"hidden"!==t.type&&(-1===l.indexOf(e)?i=Math.max(0,i-parseFloat(t.width)):n[e]<100&&(s=Math.max(0,s+(100-n[e]))))}}i-=7;for(let t=0;t<o.options.columns.length;t++){var r=o.options.columns[t];let e;"hidden"!==r.type&&-1<l.indexOf(t)&&(e=n[t]?Math.max(o.options.defaultColWidth,n[t]):o.options.defaultColWidth,a.options.fullsizeTable&&s<i&&(e=e/s*i),o.setWidth(t,e))}m(o.parent),o.options.editable=e},g=function(e){null==i.ignoreEvents&&(i.ignoreEvents=e.ignoreEvents),e.ignoreEvents=!0,null==i.ignoreCloud&&(i.ignoreCloud=e.ignoreCloud),null==i.ignoreHistory&&(i.ignoreHistory=e.ignoreHistory),e.ignoreHistory=!0,null==i.ignorePersistence&&(i.ignorePersistence=e.ignorePersistence),e.ignorePersistence=!0},m=function(e){e.ignoreEvents=i.ignoreEvents,e.ignoreHistory=i.ignoreHistory,e.ignorePersistence=i.ignorePersistence,i={}};return a}});
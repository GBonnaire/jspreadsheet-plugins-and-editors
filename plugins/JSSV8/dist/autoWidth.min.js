/**
 * Plugin for auto width cols
 *
 * @version 2.3.0
 * @author Guillaume Bonnaire <contact@gbonnaire.fr>
 * @website https://repo.gbonnaire.fr
 * @description auto size width of columns
 * - autosize all columns without width property
 *
 * @license This plugin is distribute under MIT License
 */ if(!jspreadsheet&&"function"==typeof require)var jspreadsheet=require("jspreadsheet");!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.jss_autoWidth=e()}(this,function(){return function(t,e,n){let o={};o.options=Object.assign({},e);let i="",l=[],s={},r={fullsizeTable:!1,parseAllData:!0},u={};if(t.config.worksheets)for(let f of t.config.worksheets){let d=x(f);for(let a in u[d]=[],f.columns)u[d][a]=f.columns[a].width}for(let p in null==o.options&&(o.options={}),r)o.options.hasOwnProperty(p)&&null!=o.options[p]||(o.options[p]=r[p]);o.onevent=function(t,e){"onresizecolumn"===t&&(o.beforeinit(e),c(e))},o.beforeinit=function(t){l=[];for(let e=0;e<t.options.columns.length;e++){let n=t.options.columns[e],o=x(t.options);(null==n.width||""===n.width||"auto"===n.width||u[o]&&(null==u[o][e]||""===u[o][e]))&&(l.push(e),t.options.columns[e].width=100,u[o][e]=100)}},o.init=function(t){c(t)};let c=function(t){h(t),g(t);let e=m(t);$(t),y(e,t)},h=function(t){i=t.table.style.cssText},g=function(t){t.table.style.tableLayout="auto"},$=function(t){t.table.style.cssText=i},m=function(t){let e=[];if(0===t.rows.length)return e;let n=t.rows[0].element;if(n)for(let i=0;i<n.children.length;i++){if(0===i)continue;let l=n.children[i],s=l.offsetWidth;if(o.options.parseAllData){let r=n.children[0].innerText.length,u=s;for(let f=0;f<t.rows.length;f++){let d=t.getValueFromCoords(i-1,f,!0);"string"!=typeof d&&(d=null===d?"":""+d),null==t.rows[f].element?s=Math.max(Math.ceil(d.length/r*u),s):r=Math.max(d.length,r)}}e.push(s)}return e},y=function(t,e){let n=e.options.editable;e.options.editable=!0,b(e.parent),null==e.options.defaultColWidth||""===e.options.defaultColWidth||"auto"===e.options.defaultColWidth?e.options.defaultColWidth=50:"string"==typeof e.options.defaultColWidth&&(e.options.defaultColWidth=parseInt(e.options.defaultColWidth));let i=0,s=0;if(o.options.fullsizeTable){i=e.table.parentNode.parentNode.offsetWidth-26,e.table.classList.contains("jss_hidden_index")||(i-=50),s=t.reduce(function(t,e,n){return l.indexOf(n)>-1?1===n&&-1===l.indexOf(0)?e:t+e:1===n&&-1===l.indexOf(0)?0:t});for(let r=0;r<e.options.columns.length;r++){let u=e.options.columns[r];"hidden"!==u.type&&(-1===l.indexOf(r)?i=Math.max(0,i-parseFloat(u.width)):t[r]<100&&(s=Math.max(0,s+(100-t[r]))))}}i-=7;for(let f=0;f<e.options.columns.length;f++){let d=e.options.columns[f],a;"hidden"!==d.type&&l.indexOf(f)>-1&&(a=t[f]?Math.max(e.options.defaultColWidth,t[f]):e.options.defaultColWidth,o.options.fullsizeTable&&s<i&&(a=a/s*i),e.setWidth(f,a))}w(e.parent),e.options.editable=n},b=function(t){null==s.ignoreEvents&&(s.ignoreEvents=t.ignoreEvents),t.ignoreEvents=!0,null==s.ignoreCloud&&(s.ignoreCloud=t.ignoreCloud),null==s.ignoreHistory&&(s.ignoreHistory=t.ignoreHistory),t.ignoreHistory=!0,null==s.ignorePersistence&&(s.ignorePersistence=t.ignorePersistence),t.ignorePersistence=!0},w=function(t){t.ignoreEvents=s.ignoreEvents,t.ignoreHistory=s.ignoreHistory,t.ignorePersistence=s.ignorePersistence,s={}};function x(t){let e=t.worksheetId;return(""===e||null==e)&&(e=jSuites.guid(),t.worksheetId=e),e}return o}});
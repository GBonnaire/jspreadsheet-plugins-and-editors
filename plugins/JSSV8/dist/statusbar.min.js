/**
 * Plugin statusbar for JSpreadsheet Pro
 * 
 * @version 2.1.1
 * @author Guillaume Bonnaire <contact@gbonnaire.fr>
 * @website https://repo.gbonnaire.fr
 * @summary Add status bar on bottom of JExcel
 * @namespace jss_statusbar
 * 
 * @requires Formula or Formula-Pro
 * 
 * @property {Object} options - List options of plugin
 * @property {Boolean} [options.showAddRowButton=false] - Add button on right of bar for add row
 * @property {String} [text_AddRowButton="Add {*} row(s)"] - Text for button, {*} is input field 
 * @property {Object} [options.formulas] - Formulas showed on statusbar. object.key = title of formula, object.value = formula. In formula you can use this shortcut {range} (Ref to range selected), {cells} (Ref to array of cells selected), {x1} (Ref to start col of selection), {y1} (Ref to start row of selection), {x2} (Ref to end col to selection), {y2} (Ref to end row to selection)
 * 
 * @link https://github.com/Guillaume-Bo/jexcel-plugins-and-editors/blob/master/plugins/statusbar/README.md Documentation official
 * 
 * @example 
 * jexcel(document.getElementById('spreadsheet'), {
 *	plugins: [
 *       { name:'statusBar', plugin:jss_statusbar },
 *     ],
 * });
 * @license This plugin is distributed under MIT License
 * 
 * @description Status bar is a plugin for add a status bar on bottom of the sheet like Excel. On this status bar you can add new row with button, and show information on selection (Range selected, Formulas, etc.)
 * Release notes
 * Version 2.1.1: Fix error build on webpack
 * Version 2.1.0: add compatibility v9
 * Version 2.0.1: compatibility ES6
 * Version 2.0.0: migration v8
 * Version 1.3.2: Fix compatibility
 * Version 1.3.1: Transform jexcel to jspreadsheet
 * Version 1.3.0: Compatibility for project dev in ES2015
 * Version 1.2.1: Fix bug with fullscreen + bug formula with 1 cell
 * Version 1.2.0: Add formula execute by cells selected (i.e. with results)
 */
    var jSuites;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_statusbar=t()}(this,function(){return function(e,t,n){const c=this;if(!c)throw new Error("JSpreadsheet must loaded before");if(!c.formula)throw new Error("Statusbar plugin require formula extension on JSpreadsheet");const d={};let p=null,u=null;d.options=Object.assign({},t);var o,s={showAddRowButton:!0,formulas:{Range:"{range}",SUM:"=SUM({range})",MAX:"=MAX({range})",MIN:"=MIN({range})"},text_AddRowButton:jSuites.translate("Add {*} row(s)")};for(o in null==d.options&&(d.options={}),s)d.options.hasOwnProperty(o)&&null!=d.options[o]||(d.options[o]=s[o]);function f(e,t){for(var n in t)e=e.replace(new RegExp("{[ ]?"+n+"[ ]?}","gi"),t[n]);return e}function m(){return u.querySelector(".jss_statusbar_information")}function h(){return c.current||(null!=e.getWorksheetActive()?e.worksheets[e.getWorksheetActive()]:e.worksheets[0])}return d.onevent=function(e,t){if("onload"==e)d.createStatusbar(t);else if("onselection"==e){var n=arguments[2],o=arguments[3],s=arguments[4],r=arguments[5];p=[n,o,s,r],d.generateInformation()}else if("onblur"==e){const a=m();a&&(a.innerHTML="")}},d.createStatusbar=function(e){const t=e.element,n=t.querySelector(":scope > .jtabs-content");u=document.createElement("div"),u.classList.add("jss_statusbar");e=d.options.text_AddRowButton.split("{*}");const o=document.createElement("div");o.classList.add("jss_statusbar_addrows"),d.options.showAddRowButton||(o.style.display="none");const s=document.createElement("input");s.setAttribute("type","number"),s.setAttribute("min","1"),s.setAttribute("step","1"),s.value=1;const r=document.createElement("button");r.innerHTML=e[0],r.onclick=function(e){if(d.options.showAddRowButton){const t=h();t.options.allowInsertRow&&t.insertRow(parseInt(s.value))}};const a=document.createElement("span");a.innerHTML=e[1],o.appendChild(r),o.appendChild(s),o.appendChild(a),u.appendChild(o);const i=document.createElement("div");i.classList.add("jss_statusbar_information"),u.appendChild(i),n.after(u)},d.generateInformation=function(){let e="";const i=h();var t=""==i.getData(!0).join("");null==p&&(p=i.selectedCell);var n=c.helpers.getColumnNameFromCoords(p[0],p[1]);let o;o=p[0]!=p[2]||p[1]!=p[3]?c.helpers.getColumnNameFromCoords(p[2],p[3]):"";var s,r;const a={};for(s in a.range=n+(""!=o?":"+o:""),a.cells=function(e){const n=[];var t=e.split(":");if(!t[1])return"["+t[0]+"]";e=c.helpers.getCoordsFromColumnName(t[0]),t=c.helpers.getCoordsFromColumnName(t[1]);let o,s,r,a;s=e[0]<=t[0]?(o=e[0],t[0]):(o=t[0],e[0]),a=e[1]<=t[1]?(r=e[1],t[1]):(r=t[1],e[1]);for(let t=r;t<=a;t++)for(let e=o;e<=s;e++)null!=i.results&&-1==i.results.indexOf(t)||n.push(c.helpers.getColumnNameFromCoords(e,t));return"["+n.join(",")+"]"}(a.range),a.x1=parseInt(p[0]),a.y1=parseInt(p[1]),a.x2=parseInt(p[2]),a.y2=parseInt(p[3]),d.options.formulas){const l=d.options.formulas[s];"="==l.substr(0,1)?t||(""!=e&&(e+="<span class='divisor'></span>"),null!==(r=i.executeFormula(f(l,a)))&&(e+=s+" : "+r)):(""!=e&&(e+="<span class='divisor'></span>"),e+=s+" : "+f(l,a))}p=null;const u=m();null!=u&&(u.innerHTML=e)},d}});
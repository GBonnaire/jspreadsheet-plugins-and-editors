var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_statusbar=t()}(this,function(){return function(e,t,n){var u={},d=null;u.options=Object.assign({},t);var r,s={showAddRowButton:!0,formulas:{Range:"{range}",SUM:"=SUM({range})",MAX:"=MAX({range})",MIN:"=MIN({range})"},text_AddRowButton:jSuites.translate("Add {*} row(s)")};for(r in null==u.options&&(u.options={}),s)u.options.hasOwnProperty(r)&&null!=u.options[r]||(u.options[r]=s[r]);function p(e,t){for(var n in t)e=e.replace(new RegExp("{[ ]?"+n+"[ ]?}","gi"),t[n]);return e}function c(e){return(e=null==e?m():e).content.querySelector(".jss_statusbar_information")}function m(){return jspreadsheet.current||(null!=e.getWorksheetActive()?e.worksheets[e.getWorksheetActive()]:e.worksheets[0])}return u.onevent=function(e,t){var n;"onselection"==e?(d=[arguments[2],arguments[3],arguments[4],arguments[5]],u.generateInformation()):"onblur"!=e||(n=c(t))&&(n.innerHTML="")},u.init=function(e){u.createStatusbar(e)},u.createStatusbar=function(t){var e=t.content,n=document.createElement("div");n.classList.add("jss_statusbar");var r=u.options.text_AddRowButton.split("{*}"),s=document.createElement("div");s.classList.add("jss_statusbar_addrows"),u.options.showAddRowButton&&0!=t.options.allowInsertRow||(s.style.display="none");var o=document.createElement("input");o.setAttribute("type","number"),o.setAttribute("min","1"),o.setAttribute("step","1"),o.value=1;var a=document.createElement("button");a.innerHTML=r[0],a.onclick=function(e){t.insertRow(parseInt(o.value))};var i=document.createElement("span");i.innerHTML=r[1],s.appendChild(a),s.appendChild(o),s.appendChild(i),n.appendChild(s);s=document.createElement("div");s.classList.add("jss_statusbar_information"),n.appendChild(s),e.appendChild(n)},u.generateInformation=function(){var e="",l=m(),t=""==l.getData(!0).join("");null==d&&(d=l.selectedCell);var n=jspreadsheet.helpers.getColumnNameFromCoords(d[0],d[1]);i=d[0]!=d[2]||d[1]!=d[3]?jspreadsheet.helpers.getColumnNameFromCoords(d[2],d[3]):"";var r,s={};for(r in s.range=n+(""!=i?":"+i:""),s.cells=function(e){var t=[],n=e.split(":");if(!n[1])return"["+n[0]+"]";var r,s,o,a,e=jspreadsheet.helpers.getCoordsFromColumnName(n[0]),n=jspreadsheet.helpers.getCoordsFromColumnName(n[1]);s=e[0]<=n[0]?(r=e[0],n[0]):(r=n[0],e[0]),a=e[1]<=n[1]?(o=e[1],n[1]):(o=n[1],e[1]);for(var i=o;i<=a;i++)for(var u=r;u<=s;u++)null!=l.results&&-1==l.results.indexOf(i)||t.push(jspreadsheet.helpers.getColumnNameFromCoords(u,i));return"["+t.join(",")+"]"}(s.range),s.x1=parseInt(d[0]),s.y1=parseInt(d[1]),s.x2=parseInt(d[2]),s.y2=parseInt(d[3]),u.options.formulas){var o,a=u.options.formulas[r];"="==a.substr(0,1)?t||(""!=e&&(e+="<span class='divisor'></span>"),null!==(o=l.executeFormula(p(a,s)))&&(e+=r+" : "+o)):(""!=e&&(e+="<span class='divisor'></span>"),e+=r+" : "+p(a,s))}d=null;var i=c(l);null!=i&&(i.innerHTML=e)},u}});
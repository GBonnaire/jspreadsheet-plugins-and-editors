var jSuites,formula,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),formula||"function"!=typeof require||(formula=require("formula")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_statusbar=t()}(this,function(){return function(e,t,n){const d={};let p=null,u=null;d.options=Object.assign({},t);var s,o={showAddRowButton:!0,formulas:{Range:"{range}",SUM:"=SUM({range})",MAX:"=MAX({range})",MIN:"=MIN({range})"},text_AddRowButton:jSuites.translate("Add {*} row(s)")};for(s in null==d.options&&(d.options={}),o)d.options.hasOwnProperty(s)&&null!=d.options[s]||(d.options[s]=o[s]);function c(e,t){for(var n in t)e=e.replace(new RegExp("{[ ]?"+n+"[ ]?}","gi"),t[n]);return e}function f(){return u.querySelector(".jss_statusbar_information")}function m(){return jspreadsheet.current||(null!=e.getWorksheetActive()?e.worksheets[e.getWorksheetActive()]:e.worksheets[0])}return d.onevent=function(e,t){if("onload"==e)d.createStatusbar(t);else if("onselection"==e){var n=arguments[2],s=arguments[3],o=arguments[4],r=arguments[5];p=[n,s,o,r],d.generateInformation()}else if("onblur"==e){const a=f();a&&(a.innerHTML="")}},d.createStatusbar=function(e){const t=e.element,n=t.querySelector(":scope > .jtabs-content");u=document.createElement("div"),u.classList.add("jss_statusbar");e=d.options.text_AddRowButton.split("{*}");const s=document.createElement("div");s.classList.add("jss_statusbar_addrows"),d.options.showAddRowButton||(s.style.display="none");const o=document.createElement("input");o.setAttribute("type","number"),o.setAttribute("min","1"),o.setAttribute("step","1"),o.value=1;const r=document.createElement("button");r.innerHTML=e[0],r.onclick=function(e){if(d.options.showAddRowButton){const t=m();t.options.allowInsertRow&&t.insertRow(parseInt(o.value))}};const a=document.createElement("span");a.innerHTML=e[1],s.appendChild(r),s.appendChild(o),s.appendChild(a),u.appendChild(s);const i=document.createElement("div");i.classList.add("jss_statusbar_information"),u.appendChild(i),n.after(u)},d.generateInformation=function(){let e="";const i=m();var t=""==i.getData(!0).join("");null==p&&(p=i.selectedCell);var n=jspreadsheet.helpers.getColumnNameFromCoords(p[0],p[1]);let s;s=p[0]!=p[2]||p[1]!=p[3]?jspreadsheet.helpers.getColumnNameFromCoords(p[2],p[3]):"";var o,r;const a={};for(o in a.range=n+(""!=s?":"+s:""),a.cells=function(e){const n=[];var t=e.split(":");if(!t[1])return"["+t[0]+"]";e=jspreadsheet.helpers.getCoordsFromColumnName(t[0]),t=jspreadsheet.helpers.getCoordsFromColumnName(t[1]);let s,o,r,a;o=e[0]<=t[0]?(s=e[0],t[0]):(s=t[0],e[0]),a=e[1]<=t[1]?(r=e[1],t[1]):(r=t[1],e[1]);for(let t=r;t<=a;t++)for(let e=s;e<=o;e++)null!=i.results&&-1==i.results.indexOf(t)||n.push(jspreadsheet.helpers.getColumnNameFromCoords(e,t));return"["+n.join(",")+"]"}(a.range),a.x1=parseInt(p[0]),a.y1=parseInt(p[1]),a.x2=parseInt(p[2]),a.y2=parseInt(p[3]),d.options.formulas){const l=d.options.formulas[o];"="==l.substr(0,1)?t||(""!=e&&(e+="<span class='divisor'></span>"),null!==(r=i.executeFormula(c(l,a)))&&(e+=o+" : "+r)):(""!=e&&(e+="<span class='divisor'></span>"),e+=o+" : "+c(l,a))}p=null;const u=f();null!=u&&(u.innerHTML=e)},d}});
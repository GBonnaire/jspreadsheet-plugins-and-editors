var jSuites;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):e.jss_persistenceFlag=o()}(this,function(){return function(t,e,o){var r={},s=null,c=null,a=null,n=null,i=0,u=0;r.options=Object.assign({},e);var l,d={showText:!0,showOnlyTime:!1,icon_error:"error",text_error:jSuites.translate("not saved"),icon_success:"check_circle",text_success:jSuites.translate("saved at {date}"),icon_progress:"cached",css_progress:"",text_progress:jSuites.translate("saving"),dateFormat:{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};for(l in null==r.options&&(r.options={}),d)r.options.hasOwnProperty(l)&&null!=r.options[l]||(r.options[l]=d[l]);var p=o.onload;function f(){i<=0?(u=0,n&&(jSuites.notification.isVisible=n)):(5<++u&&(console.error("TimeOut Reset",i),i=0,r.setSuccess()),setTimeout(f,1e3))}return o.onload=function(){p&&p.apply(t,arguments),function(){(s=document.createElement("div")).classList.add("jtoolbar-item"),s.classList.add("jss-flagPersistence"),r.options.showText&&(c=document.createElement("span"),s.appendChild(c));(a=document.createElement("i")).classList.add("material-icons"),a.style.cssText="display:inline-block",s.appendChild(a),t.toolbar.children[0].appendChild(s)}()},r.onevent=function(e,o){var s;"onbeforesave"==e&&t.config.toolbar?(i<0&&(i=0),n=n||jSuites.notification.isVisible,0==i&&(jSuites.notification.isVisible=function(){return!0}),i++,r.setInProgress()):"onblur"==e&&t.config.toolbar?0==i?f():setTimeout(f,1e3):"onsave"==e&&t.config.toolbar&&((s=arguments[4]).success?--i<=0&&r.setSuccess():(i=0,r.setError(),console.error(s)))},r.change=function(e,o,s,t){var n,i;-1!=o.indexOf("{date}")&&(n=new Date,i=r.options.showOnlyTime?n.toLocaleTimeString(void 0):n.toLocaleDateString(void 0,r.options.dateFormat),o=o.replace("{date}",i)),-1!=o.indexOf("{time}")&&(i=(n=new Date).toLocaleTimeString(void 0),o=o.replace("{time}",i)),a&&(a.innerHTML=e,a.style.color=t||"inherit",r.options.css_progress&&(!0===s?a.classList.add(r.options.css_progress):a.classList.remove(r.options.css_progress))),c&&(c.innerHTML=o)},r.setInProgress=function(){r.change(r.options.icon_progress,r.options.text_progress,!0)},r.setSuccess=function(){r.change(r.options.icon_success,r.options.text_success,!1,"green")},r.setError=function(){r.change(r.options.icon_error,r.options.text_error,!1,"red")},r}});
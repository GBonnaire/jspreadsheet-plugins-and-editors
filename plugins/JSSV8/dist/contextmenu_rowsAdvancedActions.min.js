/**
 * Plugin advanced actions for rows in context menu for jSpreadSheet Pro
 *
 * @version 2.1.0
 * @author Guillaume Bonnaire <contact@gbonnaire.fr>
 * @website https://repo.gbonnaire.fr
 * @description add item on contextmenu for rows
 *
 * @license This plugin is distribute under MIT License
 *
 * ReleaseNote :
 * 2.1 : Migration v10
 * 2.0 : Migration v8
 * 1.2 : Add Integration top menu
 * 1.1 : Add compatibility NPM
 */
if(!jSuites&&"function"==typeof require)var jSuites=require("jsuites");!function(o,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):o.jss_contextmenu_rowAdvancedActions=t()}(this,function(){return function(o,t,e){var n={};n.options=Object.assign({},t);var i={icon_moveup:"arrow_upward",icon_movedown:"arrow_downward",icon_duplicate:"content_copy",text_moveup:jSuites.translate("Move up row(s) selected"),text_movedown:jSuites.translate("Move down row(s) selected"),text_duplicate:jSuites.translate("Duplicate row(s) selected")};for(var c in null==n.options&&(n.options={}),i)n.options.hasOwnProperty(c)&&null!=n.options[c]||(n.options[c]=i[c]);function r(){return jspreadsheet.current?jspreadsheet.current:null!=o.getWorksheetActive()?o.worksheets[o.getWorksheetActive()]:o.worksheets[0]}return n.contextMenu=function(o,t,e,i,c){var a=r();if(null==t&&o.getSelectedRows().length){var s=0;for(var p in c)if("divisor"==c[p].type||"line"==c[p].type){s=parseInt(p)+1;break}if(a.options.rowDrag){var l={title:n.options.text_moveup,onclick:function(){var t=o.getSelectedRows();t.forEach(function(t){var e=t;o.moveRow(e,e-1)});var e=Math.max(0,t[0]-1),n=o.options.data[0].length-1,i=Math.max(0,t[t.length-1]-1);o.updateSelectionFromCoords(0,e,n,i)}};n.options.icon_moveup&&(l.icon=n.options.icon_moveup),c.splice(s,0,l),s++;var l={title:n.options.text_movedown,onclick:function(){var t=o.getSelectedRows();t.reverse().forEach(function(t){var e=t;o.moveRow(e,e+1)});var e=t[0]+1,n=o.options.data[0].length-1,i=t[t.length-1]+1;o.updateSelectionFromCoords(0,e,n,i)}};n.options.icon_movedown&&(l.icon=n.options.icon_movedown),c.splice(s,0,l),s++}var l={title:n.options.text_duplicate,onclick:function(){var t=o.getSelectedRows(),e=t[t.length-1],n=o.getData(!0);let i=[];n.forEach(function(o){i.push({row:+e+1,data:o}),e++}),o.insertRow(i);var c=t[0],r=o.options.data[0].length-1,a=e;o.updateSelectionFromCoords(0,c,r,a)}};n.options.icon_duplicate&&(l.icon=n.options.icon_duplicate),c.splice(s,0,l),s++,c.splice(s,0,{type:"line"})}return c},n.topMenu=function(o,t,e,i){if("Edit"==o){var c=r(),a=c;if(null!=c.selectedCell){if(t.push({type:"line"}),c.options.rowDrag){var s={title:n.options.text_moveup,onclick:function(){var o=a.getSelectedRows();o.forEach(function(o){var t=o;a.moveRow(t,t-1)});var t=Math.max(0,o[0]-1),e=a.options.data[0].length-1,n=Math.max(0,o[o.length-1]-1);a.updateSelectionFromCoords(0,t,e,n)}};n.options.icon_moveup&&(s.icon=n.options.icon_moveup),t.push(s);var s={title:n.options.text_movedown,onclick:function(){var o=a.getSelectedRows();o.reverse().forEach(function(o){var t=o;a.moveRow(t,t+1)});var t=o[0]+1,e=a.options.data[0].length-1,n=o[o.length-1]+1;a.updateSelectionFromCoords(0,t,e,n)}};n.options.icon_movedown&&(s.icon=n.options.icon_movedown),t.push(s)}var s={title:n.options.text_duplicate,onclick:function(){var o=a.getSelectedRows(),t=o[o.length-1],e=a.getData(!0);let n=[];e.forEach(function(o){n.push({row:+t+1,data:o}),t++}),a.insertRow(n);var i=o[0],c=a.options.data[0].length-1,r=t;a.updateSelectionFromCoords(0,i,c,r)}};n.options.icon_duplicate&&(s.icon=n.options.icon_duplicate),t.push(s)}}return t},n}});
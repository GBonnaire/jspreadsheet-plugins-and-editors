/**
 * Plugin advanced actions for rows in context menu for jSpreadSheet Pro
 * 
 * @version 2.0.0
 * @author Guillaume Bonnaire <contact@gbonnaire.fr>
 * @website https://repo.gbonnaire.fr
 * @description add item on contextmenu for rows
 * 
 * @license This plugin is distribute under MIT License
 * 
 * ReleaseNote :
 * 2.0 : Migration v8
 * 1.2 : Add Integration top menu
 * 1.1 : Add compatibility NPM
 */
var jSuites;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.jss_contextmenu_rowAdvancedActions=e()}(this,function(){return function(t,e,o){var p={};p.options=Object.assign({},e);var n,i={icon_moveup:"arrow_upward",icon_movedown:"arrow_downward",icon_duplicate:"content_copy",text_moveup:jSuites.translate("Move up row(s) selected"),text_movedown:jSuites.translate("Move down row(s) selected"),text_duplicate:jSuites.translate("Duplicate row(s) selected")};for(n in null==p.options&&(p.options={}),i)p.options.hasOwnProperty(n)&&null!=p.options[n]||(p.options[n]=i[n]);function u(){return jspreadsheet.current||(null!=t.getWorksheetActive()?t.worksheets[t.getWorksheetActive()]:t.worksheets[0])}return p.contextMenu=function(n,t,e,o,i){var a=u();if(null==t&&n.getSelectedRows().length){var r,s=0;for(r in i)if("divisor"==i[r].type||"line"==i[r].type){s=parseInt(r)+1;break}a.options.rowDrag&&(c={title:p.options.text_moveup,onclick:function(){var t=n.getSelectedRows();t.forEach(function(t){t=parseInt(t.getAttribute("data-y"));n.moveRow(t,t-1)});var e=parseInt(t[0].getAttribute("data-y")),o=n.options.data[0].length-1,t=parseInt(t[t.length-1].getAttribute("data-y"));n.updateSelectionFromCoords(0,e,o,t)}},p.options.icon_moveup&&(c.icon=p.options.icon_moveup),i.splice(s,0,c),s++,c={title:p.options.text_movedown,onclick:function(){var t=n.getSelectedRows();t.reverse().forEach(function(t){t=parseInt(t.getAttribute("data-y"));n.moveRow(t,t+1)});var e=parseInt(t[0].getAttribute("data-y")),o=n.options.data[0].length-1,t=parseInt(t[t.length-1].getAttribute("data-y"));n.updateSelectionFromCoords(0,e,o,t)}},p.options.icon_movedown&&(c.icon=p.options.icon_movedown),i.splice(s,0,c),s++);var c={title:p.options.text_duplicate,onclick:function(){var t=n.getSelectedRows(),e=parseInt(t[t.length-1].getAttribute("data-y"));n.getData(!0).forEach(function(t){n.insertRow(t,e),e++});var o=parseInt(t[0].getAttribute("data-y")),t=n.options.data[0].length-1;n.updateSelectionFromCoords(0,o,t,e)}};p.options.icon_duplicate&&(c.icon=p.options.icon_duplicate),i.splice(s,0,c),i.splice(++s,0,{type:"line"})}return i},p.topMenu=function(t,e,o,n){var i,a;return"Edit"==t&&(t=u(),null!=(i=t).selectedCell&&(e.push({type:"line"}),t.options.rowDrag&&(a={title:p.options.text_moveup,onclick:function(){var t=i.getSelectedRows();t.forEach(function(t){t=parseInt(t.getAttribute("data-y"));i.moveRow(t,t-1)});var e=parseInt(t[0].getAttribute("data-y")),o=i.options.data[0].length-1,t=parseInt(t[t.length-1].getAttribute("data-y"));i.updateSelectionFromCoords(0,e,o,t)}},p.options.icon_moveup&&(a.icon=p.options.icon_moveup),e.push(a),a={title:p.options.text_movedown,onclick:function(){var t=i.getSelectedRows();t.reverse().forEach(function(t){t=parseInt(t.getAttribute("data-y"));i.moveRow(t,t+1)});var e=parseInt(t[0].getAttribute("data-y")),o=i.options.data[0].length-1,t=parseInt(t[t.length-1].getAttribute("data-y"));i.updateSelectionFromCoords(0,e,o,t)}},p.options.icon_movedown&&(a.icon=p.options.icon_movedown),e.push(a)),a={title:p.options.text_duplicate,onclick:function(){var t=i.getSelectedRows(),e=parseInt(t[t.length-1].getAttribute("data-y"));i.getData(!0).forEach(function(t){i.insertRow(t,e),e++});var o=parseInt(t[0].getAttribute("data-y")),t=i.options.data[0].length-1;i.updateSelectionFromCoords(0,o,t,e)}},p.options.icon_duplicate&&(a.icon=p.options.icon_duplicate),e.push(a))),e},p}});
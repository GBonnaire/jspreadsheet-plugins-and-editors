var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(o,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):o.jss_utils=t()}(this,function(){return function(j,o,t){const k={};let e={};k.options=Object.assign({},o);var n={allow:{moveRow:!0,duplicateRow:!0,hideSheet:!0,hideColumn:!0,hideRow:!0,zoom:!0},icon:{moveUpRow:"arrow_upward",moveDownRow:"arrow_downward",duplicateRow:"content_copy",hideRow:"visibility_off",showRow:"visibility",hideColumn:"visibility_off",showColumn:"visibility",hideWorksheet:"visibility_off"},text:{moveUpRow:jSuites.translate("Move up row(s) selected"),moveDownRow:jSuites.translate("Move down row(s) selected"),duplicateRow:jSuites.translate("Duplicate row(s) selected"),hideRow:jSuites.translate("Hide row(s) selected"),showRow:jSuites.translate("Show row ({0})"),hideColumn:jSuites.translate("Hide column(s) selected"),showColumn:jSuites.translate("Show column ({0})"),hideWorksheet:jSuites.translate("Hide this worksheet")}};null==k.options&&(k.options={});for(const r in n)if(k.options.hasOwnProperty(r)&&null!=k.options[r]){if("object"==typeof n[r]&&!Array.isArray(n[r]))for(const a in k.options[r])k.options[r].hasOwnProperty(a)&&null!=k.options[r][a]||(k.options[r][a]=n[r][a])}else k.options[r]=n[r];k.onevent=function(o,t){"onload"==o&&i.onload(j.element,j.element.tabs),"onresize"==o&&s.updateViewport(t,arguments[2]),"onopenworksheet"!=o&&"oncreateworksheet"!=o||s.update(t)},k.toolbar=function(o){var t={type:"i",content:"zoom_in",onclick:function(){s.in(10)}},e={type:"i",content:"zoom_out",onclick:function(){s.out(10)}},n={type:"label",content:"100%",id:"zoom_label",onclick:function(){var o=prompt(jSuites.translate("Set new zoom value"),s.get());s.set(o)},updateState(o,t,e,n){e.innerText=s.get(n)+"%"}};return o.items.push({type:"divisor"}),o.items.push(e),o.items.push(n),o.items.push(t),o},k.contextMenu=function(s,o,t,e,n,i){var l=I();if(null==o&&null!=t&&s.getSelectedRows(!0).length){let o=0;for(const a in n)if("divisor"==n[a].type||"line"==n[a].type){o=parseInt(a)+1;break}if(l.options.rowDrag&&k.options.allow.moveRow){const p={title:k.options.text.moveUpRow,onclick:function(){const o=s.getSelectedRows(!0);o.forEach(function(o){s.moveRow(o,o-1)});var t=Math.min(o),e=s.options.data[0].length-1,n=Math.max(o);s.updateSelectionFromCoords(0,t,e,n)}};k.options.icon.moveUpRow&&(p.icon=k.options.icon.moveUpRow),n.splice(o,0,p),o++;const u={title:k.options.text.moveDownRow,onclick:function(){const o=s.getSelectedRows(!0);o.reverse().forEach(function(o){s.moveRow(o,o+1)});var t=Math.min(o),e=s.options.data[0].length-1,n=Math.max(o);s.updateSelectionFromCoords(0,t,e,n)}};k.options.icon.moveDownRow&&(u.icon=k.options.icon.moveDownRow),n.splice(o,0,u),o++}if(l.options.editable&&k.options.allow.duplicateRow){const d={title:k.options.text.duplicateRow,onclick:function(){var o=s.getSelectedRows(!0);let t=Math.max(o);const e=s.getData(!0);e.forEach(function(o){s.insertRow(o,t),t++});var n=Math.min(o),i=s.options.data[0].length-1,o=t;s.updateSelectionFromCoords(0,n,i,o)}};k.options.icon.duplicateRow&&(d.icon=k.options.icon.duplicateRow),n.splice(o,0,d),o++}if(k.options.allow.hideRow){const h={title:k.options.text.hideRow,onclick:function(){const o=s.getSelectedRows(!0);o.forEach(function(o){s.hideRow(o)})}};k.options.icon.hideRow&&(h.icon=k.options.icon.hideRow),n.splice(o,0,h),o++;const w=Math.min(s.getSelectedRows(!0)),m=Math.min(s.getSelectedRows(!0));var c=s.getRow(w-1),r=s.getRow(m+1);if(c&&!1===c.visible){const f={title:k.options.text.showRow.replace("{0}",c.title??w+1-1),onclick:function(){s.showRow(w-1)}};k.options.icon.showRow&&(f.icon=k.options.icon.showRow),n.splice(o,0,f),o++}if(r&&!1===r.visible){const g={title:k.options.text.showRow.replace("{0}",r.title??m+1+1),onclick:function(){s.showRow(m+1)}};k.options.icon.showRow&&(g.icon=k.options.icon.showRow),n.splice(o,0,g),o++}}n.splice(o,0,{type:"line"})}else if(null==t&&null!=o&&s.getSelectedColumns().length){let o=0;for(const v in n)if(n[v].title===jSuites.translate("Insert a new column before")){o=parseInt(v);break}if(k.options.allow.hideColumn){const R={title:k.options.text.hideColumn,onclick:function(){const o=s.getSelectedColumns();o.forEach(function(o){s.hideColumn(o)})}};k.options.icon.hideColumn&&(R.icon=k.options.icon.hideColumn),n.splice(o,0,R),o++;const y=Math.min(s.getSelectedColumns()),b=Math.min(s.getSelectedColumns());c=s.getColumn(y-1),r=s.getColumn(b+1);if(c&&!1===c.visible){const S={title:k.options.text.showColumn.replace("{0}",c.title||jspreadsheet.helpers.getColumnName(y-1)),onclick:function(){s.showColumn(y-1)}};k.options.icon.showColumn&&(S.icon=k.options.icon.showColumn),n.splice(o,0,S),o++}if(r&&!1===r.visible){const C={title:k.options.text.showColumn.replace("{0}",r.title||jspreadsheet.helpers.getColumnName(b+1)),onclick:function(){s.showColumn(b+1)}};k.options.icon.showColumn&&(C.icon=k.options.icon.showColumn),n.splice(o,0,C),o++}}}else if(null==o&&null==t&&"tabs"==i){i=Array.isArray(j.el.jspreadsheet)?j.el.jspreadsheet.length:1;if(1<i&&k.options.allow.hideSheet){const x={title:k.options.text.hideWorksheet,onclick:function(){let o=j.el.tabs.headers.querySelector(".jtabs-selected");if(o){o.style.display="none";var n=Array.prototype.indexOf.call(j.el.tabs.headers.children,o);let t=1,e=n;for(let o=0;o<=j.el.tabs.headers.children.length-2&&(e+=t,!(e<0));o++){const i=j.el.tabs.headers.children[e];if(i.classList.contains("jtabs-border"))t=-1,e=n;else if("none"!==i.style.display){j.el.tabs.open(e);break}}}}};k.options.icon.hideWorksheet&&(x.icon=k.options.icon.hideWorksheet),n.unshift(x)}}return n},k.topMenu=function(o,t,e,n){if("Edit"===o){o=I();const s=o;if(null!=o.selectedCell){if(t.push({type:"line"}),o.options.rowDrag){const l={title:k.options.text.moveUpRow,onclick:function(){const o=s.getSelectedRows(!0);o.forEach(function(o){s.moveRow(o,o-1)});var t=Math.min(o),e=s.options.data[0].length-1,n=Math.max(o);s.updateSelectionFromCoords(0,t,e,n)}};k.options.icon.moveUpRow&&(l.icon=k.options.icon.moveUpRow),t.push(l);const c={title:k.options.text.moveDownRow,onclick:function(){const o=s.getSelectedRows(!0);o.reverse().forEach(function(o){s.moveRow(o,o+1)});var t=Math.min(o),e=s.options.data[0].length-1,n=Math.max(o);s.updateSelectionFromCoords(0,t,e,n)}};k.options.icon.moveDownRow&&(c.icon=k.options.icon.moveDownRow),t.push(c)}const i={title:k.options.text.duplicateRow,onclick:function(){var o=s.getSelectedRows(!0);let t=Math.max(o);const e=s.getData(!0);e.forEach(function(o){s.insertRow(o,t),t++});var n=Math.min(o),i=s.options.data[0].length-1,o=t;s.updateSelectionFromCoords(0,n,i,o)}};k.options.icon.duplicateRow&&(i.icon=k.options.icon.duplicateRow),t.push(i)}}return t};const i=function(){const o={onload:function(o,s){const t=s.headers.parentNode,e=document.createElement("DIV");e.className="jss_contextmenu",o.appendChild(e);const l=jSuites.contextmenu(e,{onclick:function(){l.close()}}),n=document.createElement("DIV");n.classList.add("jtabs-menu"),n.style.cursor="pointer";const i=document.createElement("SPAN");i.classList.add("material-icons"),i.innerHTML="list",n.append(i),n.addEventListener("click",function(o){o=o.target.getBoundingClientRect(),o={x:o.left,y:o.top+o.height};const n=[];for(let e=0;e<s.headers.children.length;e++)if(!s.headers.children[e].classList.contains("jtabs-border")){var i=s.headers.children[e].querySelector(".material-icons");let o=null,t="";t=i?(o=i.innerText,s.headers.children[e].innerText.substring(o.length)):s.headers.children[e].innerText,"none"===s.headers.children[e].style.display&&(t+=" "+jSuites.translate("(hidden)")),n.push({title:t,icon:o,disabled:s.headers.children[e].classList.contains("jtabs-selected"),onclick:function(o){return function(){"none"===s.headers.children[o].style.display&&(s.headers.children[o].style.display=""),s.open(o)}}(e)})}s.options.allowCreate&&n.push({title:jSuites.translate("New tab"),icon:"add_box",onclick:function(){s.create()}}),l.open(o,n)}),t.insertBefore(n,t.firstChild)}};return o}(),s=function(){const i={init:function(o){null==(o=null==o?I():o).options.pluginOptions&&(o.options.pluginOptions={}),null==o.options.pluginOptions.zoom&&(o.options.pluginOptions.zoom={value:100},i.updateViewport(),o.options.tableOverflow||window.addEventListener("scroll",function(){var o=I(),t=s.get(o)/100,e=document.body.scrollTop-document.body.scrollTop/t;for(const n of o.headerContainer.children)n.style.top=`${-e}px`}))},updateViewport:function(o,t,e){null==e&&(e=I()),i.init(e),null==o&&(o=parseInt(e.content.style.width||e.content.offsetWidth)),null==t&&(t=parseInt(e.content.style.height||e.content.style.offsetHeight)),e.options.pluginOptions.zoom.tableWidthInit=parseInt(o*i.get(e)/100),isNaN(e.options.pluginOptions.zoom.tableWidthInit)&&(e.options.pluginOptions.zoom.tableWidthInit=null),e.options.pluginOptions.zoom.tableHeightInit=parseInt(t*i.get(e)/100),isNaN(e.options.pluginOptions.zoom.tableHeightInit)&&(e.options.pluginOptions.zoom.tableHeightInit=null)},update:function(o){null==o&&(o=I()),i.init(o);var t=o.options.pluginOptions.zoom.tableHeightInit/(i.get(o)/100);o.content.style.marginBottom=`${o.options.pluginOptions.zoom.tableHeightInit-parseInt(t)}px`},set:function(o,t){var e,n;isNaN(parseInt(o))||(null==t&&(t=I()),e=Math.max(10,Math.min(200,parseInt(o))),t&&(t.content.style.transform="scale("+e/100+")",t.content.style.transformOrigin="top left",i.init(t),t.options.pluginOptions.zoom.value=e,n=t.options.pluginOptions.zoom.tableWidthInit/(e/100),o=t.options.pluginOptions.zoom.tableHeightInit/(e/100),t.content.style.marginBottom=`${t.options.pluginOptions.zoom.tableHeightInit-parseInt(o)}px`,t.options.tableOverflow?(l(),t.setViewport(parseInt(n),parseInt(o)),c()):j.toolbar.querySelector("#zoom_label").innerText=e+"%",i.update(t),t.dispatch("onzoom",t,e)))},get:function(o){return null==o&&(o=I()),i.init(o),o.options.pluginOptions.zoom.value},in:function(o,t){this.set(i.get()+o,t)},out:function(o,t){this.set(i.get()-o,t)}};return i}();function I(){return jspreadsheet.current||(null!=j.getWorksheetActive()?j.worksheets[j.getWorksheetActive()]:j.worksheets[0])}const l=function(){null==e.ignoreEvents&&(e.ignoreEvents=j.ignoreEvents),j.ignoreEvents=!0,null==e.ignoreCloud&&(e.ignoreCloud=j.ignoreCloud),null==e.ignoreHistory&&(e.ignoreHistory=j.ignoreHistory),j.ignoreHistory=!0,null==e.ignorePersistence&&(e.ignorePersistence=j.ignorePersistence),j.ignorePersistence=!0},c=function(){j.ignoreEvents=e.ignoreEvents,j.ignoreHistory=e.ignoreHistory,j.ignorePersistence=e.ignorePersistence,j.ignoreCloud=e.ignoreCloud,e={}};return k}});
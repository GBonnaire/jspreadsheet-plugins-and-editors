var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.jss_utils=e()}(this,function(){return function(y,t,e){const b={};b.options=Object.assign({},t);var o={allow:{moveRow:!0,duplicateRow:!0,hideSheet:!0,hideColumn:!0,zoom:!0},icon:{moveUpRow:"arrow_upward",moveDownRow:"arrow_downward",duplicateRow:"content_copy",hideColumn:"visibility_off",showColumn:"visibility",hideWorksheet:"visibility_off"},text:{moveUpRow:jSuites.translate("Move up row(s) selected"),moveDownRow:jSuites.translate("Move down row(s) selected"),duplicateRow:jSuites.translate("Duplicate row(s) selected"),hideColumn:jSuites.translate("Hide column(s) selected"),showColumn:jSuites.translate("Show column ({0})"),hideWorksheet:jSuites.translate("Hide this worksheet")}};null==b.options&&(b.options={});for(const s in o)if(b.options.hasOwnProperty(s)&&null!=b.options[s]){if("object"==typeof o[s]&&!Array.isArray(o[s]))for(const l in b.options[s])b.options[s].hasOwnProperty(l)&&null!=b.options[s][l]||(b.options[s][l]=o[s][l])}else b.options[s]=o[s];b.onevent=function(t,e){"onload"==t&&n.onload(y.element,y.element.tabs)},b.toolbar=function(t){var e,o,n;return b.options.allow.zoom&&R().options.tableOverflow&&9<=parseInt(jspreadsheet.version().version.split(".")[0])&&(e={type:"i",content:"zoom_in",onclick:function(){i.in()}},o={type:"i",content:"zoom_out",onclick:function(){i.out()}},n={type:"label",content:"100%",id:"zoom_label",onclick:function(){var t=prompt(jSuites.translate("Set new zoom value"),i.value);i.set(t)}},t.items.push({type:"divisor"}),t.items.push(o),t.items.push(n),t.items.push(e)),t},b.contextMenu=function(l,t,e,o,n,i){var s=R();if(null==t&&null!=e&&l.getSelectedRows().length){let t=0;for(const r in n)if("divisor"==n[r].type||"line"==n[r].type){t=parseInt(r)+1;break}if(s.options.rowDrag&&b.options.allow.moveRow){const c={title:b.options.text.moveUpRow,onclick:function(){const t=l.getSelectedRows();t.forEach(function(t){t=parseInt(t.getAttribute("data-y"));l.moveRow(t,t-1)});var e=parseInt(t[0].getAttribute("data-y")),o=l.options.data[0].length-1,n=parseInt(t[t.length-1].getAttribute("data-y"));l.updateSelectionFromCoords(0,e,o,n)}};b.options.icon.moveUpRow&&(c.icon=b.options.icon.moveUpRow),n.splice(t,0,c),t++;const p={title:b.options.text.moveDownRow,onclick:function(){const t=l.getSelectedRows();t.reverse().forEach(function(t){t=parseInt(t.getAttribute("data-y"));l.moveRow(t,t+1)});var e=parseInt(t[0].getAttribute("data-y")),o=l.options.data[0].length-1,n=parseInt(t[t.length-1].getAttribute("data-y"));l.updateSelectionFromCoords(0,e,o,n)}};b.options.icon.moveDownRow&&(p.icon=b.options.icon.moveDownRow),n.splice(t,0,p),t++}if(s.options.editable&&b.options.allow.duplicateRow){const u={title:b.options.text.duplicateRow,onclick:function(){const t=l.getSelectedRows();let e=parseInt(t[t.length-1].getAttribute("data-y"));const o=l.getData(!0);o.forEach(function(t){l.insertRow(t,e),e++});var n=parseInt(t[0].getAttribute("data-y")),i=l.options.data[0].length-1,s=e;l.updateSelectionFromCoords(0,n,i,s)}};b.options.icon.duplicateRow&&(u.icon=b.options.icon.duplicateRow),n.splice(t,0,u),t++}n.splice(t,0,{type:"line"})}else if(null==e&&null!=t&&l.getSelectedColumns().length){let t=0;for(const d in n)if(n[d].title===jSuites.translate("Insert a new column before")){t=parseInt(d);break}if(b.options.allow.hideColumn){const h={title:b.options.text.hideColumn,onclick:function(){const t=l.getSelectedColumns();t.forEach(function(t){l.hideColumn(t)})}};b.options.icon.hideColumn&&(h.icon=b.options.icon.hideColumn),n.splice(t,0,h),t++;const m=Math.min(l.getSelectedColumns()),f=Math.min(l.getSelectedColumns());var a=l.getColumn(m-1),s=l.getColumn(f+1);if(a&&!1===a.visible){const w={title:b.options.text.showColumn.replace("{0}",a.title||jspreadsheet.helpers.getColumnName(m-1)),onclick:function(){l.showColumn(m-1)}};b.options.icon.showColumn&&(w.icon=b.options.icon.showColumn),n.splice(t,0,w),t++}if(s&&!1===s.visible){const g={title:b.options.text.showColumn.replace("{0}",s.title||jspreadsheet.helpers.getColumnName(f+1)),onclick:function(){l.showColumn(f+1)}};b.options.icon.showColumn&&(g.icon=b.options.icon.showColumn),n.splice(t,0,g),t++}}}else if(null==t&&null==e&&"tabs"==i){i=Array.isArray(y.el.jspreadsheet)?y.el.jspreadsheet.length:1;if(1<i&&b.options.allow.hideSheet){const v={title:b.options.text.hideWorksheet,onclick:function(){let t=y.el.tabs.headers.querySelector(".jtabs-selected");if(t){t.style.display="none";var n=Array.prototype.indexOf.call(y.el.tabs.headers.children,t);let e=1,o=n;for(let t=0;t<=y.el.tabs.headers.children.length-2&&(o+=e,!(o<0));t++){const i=y.el.tabs.headers.children[o];if(i.classList.contains("jtabs-border"))e=-1,o=n;else if("none"!==i.style.display){y.el.tabs.open(o);break}}}}};b.options.icon.hideWorksheet&&(v.icon=b.options.icon.hideWorksheet),n.unshift(v)}}return n},b.topMenu=function(t,e,o,n){if("Edit"===t){t=R();const l=t;if(null!=t.selectedCell){if(e.push({type:"line"}),t.options.rowDrag){const s={title:b.options.text.moveUpRow,onclick:function(){const t=l.getSelectedRows();t.forEach(function(t){t=parseInt(t.getAttribute("data-y"));l.moveRow(t,t-1)});var e=parseInt(t[0].getAttribute("data-y")),o=l.options.data[0].length-1,n=parseInt(t[t.length-1].getAttribute("data-y"));l.updateSelectionFromCoords(0,e,o,n)}};b.options.icon.moveUpRow&&(s.icon=b.options.icon.moveUpRow),e.push(s);const a={title:b.options.text.moveDownRow,onclick:function(){const t=l.getSelectedRows();t.reverse().forEach(function(t){t=parseInt(t.getAttribute("data-y"));l.moveRow(t,t+1)});var e=parseInt(t[0].getAttribute("data-y")),o=l.options.data[0].length-1,n=parseInt(t[t.length-1].getAttribute("data-y"));l.updateSelectionFromCoords(0,e,o,n)}};b.options.icon.moveDownRow&&(a.icon=b.options.icon.moveDownRow),e.push(a)}const i={title:b.options.text.duplicateRow,onclick:function(){const t=l.getSelectedRows();let e=parseInt(t[t.length-1].getAttribute("data-y"));const o=l.getData(!0);o.forEach(function(t){l.insertRow(t,e),e++});var n=parseInt(t[0].getAttribute("data-y")),i=l.options.data[0].length-1,s=e;l.updateSelectionFromCoords(0,n,i,s)}};b.options.icon.duplicateRow&&(i.icon=b.options.icon.duplicateRow),e.push(i)}}return e};const n=function(){const t={onload:function(t,s){const e=s.headers.parentNode,o=document.createElement("DIV");o.className="jss_contextmenu",t.appendChild(o);const l=jSuites.contextmenu(o,{onclick:function(){l.close()}}),n=document.createElement("DIV");n.classList.add("jtabs-menu"),n.style.cursor="pointer";const i=document.createElement("SPAN");i.classList.add("material-icons"),i.innerHTML="list",n.append(i),n.addEventListener("click",function(t){t=t.target.getBoundingClientRect(),t={x:t.left,y:t.top+t.height};const n=[];for(let o=0;o<s.headers.children.length;o++)if(!s.headers.children[o].classList.contains("jtabs-border")){var i=s.headers.children[o].querySelector(".material-icons");let t=null,e="";e=i?(t=i.innerText,s.headers.children[o].innerText.substring(t.length)):s.headers.children[o].innerText,"none"===s.headers.children[o].style.display&&(e+=" "+jSuites.translate("(hidden)")),n.push({title:e,icon:t,disabled:s.headers.children[o].classList.contains("jtabs-selected"),onclick:function(t){return function(){"none"===s.headers.children[t].style.display&&(s.headers.children[t].style.display=""),s.open(t)}}(o)})}s.options.allowCreate&&n.push({title:jSuites.translate("New tab"),icon:"add_box",onclick:function(){s.create()}}),l.open(t,n)}),e.insertBefore(n,e.firstChild)}};return t}(),i=function(){const n={value:100,set:function(t){if(!isNaN(parseInt(t))){n.value=Math.max(10,Math.min(200,parseInt(t)));const o=R();var e;o&&(o.content.style.transform="scale("+n.value/100+")",o.content.style.transformOrigin="top left",null==o.options.pluginOptions&&(o.options.pluginOptions={}),null==o.options.pluginOptions.zoom&&(o.options.pluginOptions.zoom={}),null==o.options.pluginOptions.zoom.tableWidthInit&&(o.options.pluginOptions.zoom.tableWidthInit=parseInt(o.content.style.width||o.content.style.maxWidth)),null==o.options.pluginOptions.zoom.tableHeightInit&&(o.options.pluginOptions.zoom.tableHeightInit=parseInt(o.content.style.height||o.content.style.maxHeight)),e=o.options.pluginOptions.zoom.tableWidthInit/(n.value/100),t=o.options.pluginOptions.zoom.tableHeightInit/(n.value/100),o.content.style.marginBottom=`${o.options.pluginOptions.zoom.tableHeightInit-parseInt(t)}px`,o.options.tableOverflow&&o.setViewport(parseInt(e),parseInt(t)),y.toolbar.querySelector("#zoom_label").innerText=n.value+"%")}},get:function(){return n.value},in:function(t=10){this.set(n.value+t)},out:function(t=10){this.set(n.value-t)}};return n}();function R(){return jspreadsheet.current||(null!=y.getWorksheetActive()?y.worksheets[y.getWorksheetActive()]:y.worksheets[0])}return b}});
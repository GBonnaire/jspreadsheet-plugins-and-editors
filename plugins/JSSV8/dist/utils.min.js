var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.jss_utils=e()}(this,function(){return function(v,t,e){const b={};let o={};b.options=Object.assign({},t);var n={allow:{moveRow:!0,duplicateRow:!0,hideSheet:!0,hideColumn:!0,zoom:!0},icon:{moveUpRow:"arrow_upward",moveDownRow:"arrow_downward",duplicateRow:"content_copy",hideColumn:"visibility_off",showColumn:"visibility",hideWorksheet:"visibility_off"},text:{moveUpRow:jSuites.translate("Move up row(s) selected"),moveDownRow:jSuites.translate("Move down row(s) selected"),duplicateRow:jSuites.translate("Duplicate row(s) selected"),hideColumn:jSuites.translate("Hide column(s) selected"),showColumn:jSuites.translate("Show column ({0})"),hideWorksheet:jSuites.translate("Hide this worksheet")}};null==b.options&&(b.options={});for(const a in n)if(b.options.hasOwnProperty(a)&&null!=b.options[a]){if("object"==typeof n[a]&&!Array.isArray(n[a]))for(const c in b.options[a])b.options[a].hasOwnProperty(c)&&null!=b.options[a][c]||(b.options[a][c]=n[a][c])}else b.options[a]=n[a];b.onevent=function(t,e){"onload"==t&&i.onload(v.element,v.element.tabs),"onresize"==t&&s.updateViewport(e,arguments[2]),"onopenworksheet"!=t&&"oncreateworksheet"!=t||s.update(e)},b.toolbar=function(t){var e={type:"i",content:"zoom_in",onclick:function(){s.in(10)}},o={type:"i",content:"zoom_out",onclick:function(){s.out(10)}},n={type:"label",content:"100%",id:"zoom_label",onclick:function(){var t=prompt(jSuites.translate("Set new zoom value"),s.get());s.set(t)},updateState(t,e,o,n){o.innerText=s.get(n)+"%"}};return t.items.push({type:"divisor"}),t.items.push(o),t.items.push(n),t.items.push(e),t},b.contextMenu=function(l,t,e,o,n,i){var s=C();if(null==t&&null!=e&&l.getSelectedRows().length){let t=0;for(const a in n)if("divisor"==n[a].type||"line"==n[a].type){t=parseInt(a)+1;break}if(s.options.rowDrag&&b.options.allow.moveRow){const c={title:b.options.text.moveUpRow,onclick:function(){const t=l.getSelectedRows();t.forEach(function(t){t=parseInt(t.getAttribute("data-y"));l.moveRow(t,t-1)});var e=parseInt(t[0].getAttribute("data-y")),o=l.options.data[0].length-1,n=parseInt(t[t.length-1].getAttribute("data-y"));l.updateSelectionFromCoords(0,e,o,n)}};b.options.icon.moveUpRow&&(c.icon=b.options.icon.moveUpRow),n.splice(t,0,c),t++;const p={title:b.options.text.moveDownRow,onclick:function(){const t=l.getSelectedRows();t.reverse().forEach(function(t){t=parseInt(t.getAttribute("data-y"));l.moveRow(t,t+1)});var e=parseInt(t[0].getAttribute("data-y")),o=l.options.data[0].length-1,n=parseInt(t[t.length-1].getAttribute("data-y"));l.updateSelectionFromCoords(0,e,o,n)}};b.options.icon.moveDownRow&&(p.icon=b.options.icon.moveDownRow),n.splice(t,0,p),t++}if(s.options.editable&&b.options.allow.duplicateRow){const u={title:b.options.text.duplicateRow,onclick:function(){const t=l.getSelectedRows();let e=parseInt(t[t.length-1].getAttribute("data-y"));const o=l.getData(!0);o.forEach(function(t){l.insertRow(t,e),e++});var n=parseInt(t[0].getAttribute("data-y")),i=l.options.data[0].length-1,s=e;l.updateSelectionFromCoords(0,n,i,s)}};b.options.icon.duplicateRow&&(u.icon=b.options.icon.duplicateRow),n.splice(t,0,u),t++}n.splice(t,0,{type:"line"})}else if(null==e&&null!=t&&l.getSelectedColumns().length){let t=0;for(const d in n)if(n[d].title===jSuites.translate("Insert a new column before")){t=parseInt(d);break}if(b.options.allow.hideColumn){const h={title:b.options.text.hideColumn,onclick:function(){const t=l.getSelectedColumns();t.forEach(function(t){l.hideColumn(t)})}};b.options.icon.hideColumn&&(h.icon=b.options.icon.hideColumn),n.splice(t,0,h),t++;const g=Math.min(l.getSelectedColumns()),m=Math.min(l.getSelectedColumns());var r=l.getColumn(g-1),s=l.getColumn(m+1);if(r&&!1===r.visible){const f={title:b.options.text.showColumn.replace("{0}",r.title||jspreadsheet.helpers.getColumnName(g-1)),onclick:function(){l.showColumn(g-1)}};b.options.icon.showColumn&&(f.icon=b.options.icon.showColumn),n.splice(t,0,f),t++}if(s&&!1===s.visible){const w={title:b.options.text.showColumn.replace("{0}",s.title||jspreadsheet.helpers.getColumnName(m+1)),onclick:function(){l.showColumn(m+1)}};b.options.icon.showColumn&&(w.icon=b.options.icon.showColumn),n.splice(t,0,w),t++}}}else if(null==t&&null==e&&"tabs"==i){i=Array.isArray(v.el.jspreadsheet)?v.el.jspreadsheet.length:1;if(1<i&&b.options.allow.hideSheet){const y={title:b.options.text.hideWorksheet,onclick:function(){let t=v.el.tabs.headers.querySelector(".jtabs-selected");if(t){t.style.display="none";var n=Array.prototype.indexOf.call(v.el.tabs.headers.children,t);let e=1,o=n;for(let t=0;t<=v.el.tabs.headers.children.length-2&&(o+=e,!(o<0));t++){const i=v.el.tabs.headers.children[o];if(i.classList.contains("jtabs-border"))e=-1,o=n;else if("none"!==i.style.display){v.el.tabs.open(o);break}}}}};b.options.icon.hideWorksheet&&(y.icon=b.options.icon.hideWorksheet),n.unshift(y)}}return n},b.topMenu=function(t,e,o,n){if("Edit"===t){t=C();const l=t;if(null!=t.selectedCell){if(e.push({type:"line"}),t.options.rowDrag){const s={title:b.options.text.moveUpRow,onclick:function(){const t=l.getSelectedRows();t.forEach(function(t){t=parseInt(t.getAttribute("data-y"));l.moveRow(t,t-1)});var e=parseInt(t[0].getAttribute("data-y")),o=l.options.data[0].length-1,n=parseInt(t[t.length-1].getAttribute("data-y"));l.updateSelectionFromCoords(0,e,o,n)}};b.options.icon.moveUpRow&&(s.icon=b.options.icon.moveUpRow),e.push(s);const r={title:b.options.text.moveDownRow,onclick:function(){const t=l.getSelectedRows();t.reverse().forEach(function(t){t=parseInt(t.getAttribute("data-y"));l.moveRow(t,t+1)});var e=parseInt(t[0].getAttribute("data-y")),o=l.options.data[0].length-1,n=parseInt(t[t.length-1].getAttribute("data-y"));l.updateSelectionFromCoords(0,e,o,n)}};b.options.icon.moveDownRow&&(r.icon=b.options.icon.moveDownRow),e.push(r)}const i={title:b.options.text.duplicateRow,onclick:function(){const t=l.getSelectedRows();let e=parseInt(t[t.length-1].getAttribute("data-y"));const o=l.getData(!0);o.forEach(function(t){l.insertRow(t,e),e++});var n=parseInt(t[0].getAttribute("data-y")),i=l.options.data[0].length-1,s=e;l.updateSelectionFromCoords(0,n,i,s)}};b.options.icon.duplicateRow&&(i.icon=b.options.icon.duplicateRow),e.push(i)}}return e};const i=function(){const t={onload:function(t,s){const e=s.headers.parentNode,o=document.createElement("DIV");o.className="jss_contextmenu",t.appendChild(o);const l=jSuites.contextmenu(o,{onclick:function(){l.close()}}),n=document.createElement("DIV");n.classList.add("jtabs-menu"),n.style.cursor="pointer";const i=document.createElement("SPAN");i.classList.add("material-icons"),i.innerHTML="list",n.append(i),n.addEventListener("click",function(t){t=t.target.getBoundingClientRect(),t={x:t.left,y:t.top+t.height};const n=[];for(let o=0;o<s.headers.children.length;o++)if(!s.headers.children[o].classList.contains("jtabs-border")){var i=s.headers.children[o].querySelector(".material-icons");let t=null,e="";e=i?(t=i.innerText,s.headers.children[o].innerText.substring(t.length)):s.headers.children[o].innerText,"none"===s.headers.children[o].style.display&&(e+=" "+jSuites.translate("(hidden)")),n.push({title:e,icon:t,disabled:s.headers.children[o].classList.contains("jtabs-selected"),onclick:function(t){return function(){"none"===s.headers.children[t].style.display&&(s.headers.children[t].style.display=""),s.open(t)}}(o)})}s.options.allowCreate&&n.push({title:jSuites.translate("New tab"),icon:"add_box",onclick:function(){s.create()}}),l.open(t,n)}),e.insertBefore(n,e.firstChild)}};return t}(),s=function(){const i={init:function(t){null==(t=null==t?C():t).options.pluginOptions&&(t.options.pluginOptions={}),null==t.options.pluginOptions.zoom&&(t.options.pluginOptions.zoom={value:100},i.updateViewport(),t.options.tableOverflow||window.addEventListener("scroll",function(){var t=C(),e=s.get(t)/100,o=document.body.scrollTop-document.body.scrollTop/e;for(const n of t.headerContainer.children)n.style.top=`${-o}px`}))},updateViewport:function(t,e,o){null==o&&(o=C()),i.init(o),null==t&&(t=parseInt(o.content.style.width||o.content.style.maxWidth)),null==e&&(e=parseInt(o.content.style.height||o.content.style.maxHeight)),o.options.pluginOptions.zoom.tableWidthInit=parseInt(t*i.get(o)/100),o.options.pluginOptions.zoom.tableHeightInit=parseInt(e*i.get(o)/100)},update:function(t){null==t&&(t=C()),i.init(t);var e=t.options.pluginOptions.zoom.tableHeightInit/(i.get(t)/100);t.content.style.marginBottom=`${t.options.pluginOptions.zoom.tableHeightInit-parseInt(e)}px`},set:function(t,e){var o,n;isNaN(parseInt(t))||(null==e&&(e=C()),o=Math.max(10,Math.min(200,parseInt(t))),e&&(e.content.style.transform="scale("+o/100+")",e.content.style.transformOrigin="top left",i.init(e),e.options.pluginOptions.zoom.value=o,n=e.options.pluginOptions.zoom.tableWidthInit/(o/100),t=e.options.pluginOptions.zoom.tableHeightInit/(o/100),e.content.style.marginBottom=`${e.options.pluginOptions.zoom.tableHeightInit-parseInt(t)}px`,e.options.tableOverflow?(l(),e.setViewport(parseInt(n),parseInt(t)),r()):v.toolbar.querySelector("#zoom_label").innerText=i.get(e)+"%",i.update(e),e.dispatch("onzoom",e,o)))},get:function(t){return null==t&&(t=C()),i.init(t),t.options.pluginOptions.zoom.value},in:function(t,e){this.set(i.get()+t,e)},out:function(t,e){this.set(i.get()-t,e)}};return i}();function C(){return jspreadsheet.current||(null!=v.getWorksheetActive()?v.worksheets[v.getWorksheetActive()]:v.worksheets[0])}const l=function(){null==o.ignoreEvents&&(o.ignoreEvents=v.ignoreEvents),v.ignoreEvents=!0,null==o.ignoreCloud&&(o.ignoreCloud=v.ignoreCloud),null==o.ignoreHistory&&(o.ignoreHistory=v.ignoreHistory),v.ignoreHistory=!0,null==o.ignorePersistence&&(o.ignorePersistence=v.ignorePersistence),v.ignorePersistence=!0},r=function(){v.ignoreEvents=o.ignoreEvents,v.ignoreHistory=o.ignoreHistory,v.ignorePersistence=o.ignorePersistence,v.ignoreCloud=o.ignoreCloud,o={}};return b}});
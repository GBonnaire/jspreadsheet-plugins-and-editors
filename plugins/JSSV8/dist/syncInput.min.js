/**
 * Plugin for sync data (json) in jSpreadsheet pro in input
 *
 * @version 2.1.0
 * @author Guillaume Bonnaire <contact@gbonnaire.fr>
 * @website https://repo.gbonnaire.fr
 * @description sync data (json) in JSpreadsheet in input
 * ReleaseNote:
 * 2.1 : Manage multiple worksheets
 * 2.0 : Migrate on JSS v8
 * @license This plugin is distribute under MIT License
 */
var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.jss_syncInput=n()}(this,function(){return function(o,e,n){const l={};l.options=Object.assign({},e);var t,i={inputElement:null,inputId:null,checkRow:null,fieldsRequired:[],processedValues:!0,worksheetId:null};for(t in null==l.options&&(l.options={}),i)l.options.hasOwnProperty(t)&&null!=l.options[t]||(l.options[t]=i[t]);function s(e){if(null!=e){const r=[];var n,o=e.worksheets;for(n of o)r.push(n.getJson(!1,l.options.processedValues));const p=[];for(let t=0;t<r.length;t++){if(1==r[t].length){let e=!0;for(var i in r[0])if(r[t][0][i]){e=!1;break}e&&(r[t]=[[]])}p[t]=[];for(let e=0;e<r[t].length;e++){const u=r[t][e];if((!Array.isArray(u)||""!==u.join(""))&&(Array.isArray(u)||""!==Object.values(u).join(""))){let n=!0;for(let e=0;e<l.options.fieldsRequired.length;e++){var s=l.options.fieldsRequired[e];if(null==u[s]||""==u[s]){n=!1;break}}n&&("function"==typeof l.options.checkRow&&(n=l.options.checkRow(u,o[t],e,t)),n&&p[t].push(u))}}}l.options.inputElement.value=JSON.stringify(p)}}function r(){l.options.inputId||!function e(n){null==n&&(n="");o.el.id?l.options.inputId=o.el.id+"_DATA"+n:l.options.inputId="JSS_DATA"+n;document.getElementById(l.options.inputId)&&(""==n&&(n=0),e(parseInt(n)+1))}();var e=l.options.inputId,n=document.createElement("input");n.id=e,n.name=e,n.type="hidden",o.el.append(n),l.options.inputElement=n}function p(e){let n=e.options.worksheetId;return""===n&&(n=jSuites.guid(),e.options.worksheetId=n),n}return l.onevent=function(e,n){"onload"==e?(function(){{var e;l.options.inputElement||(l.options.inputId&&(e=document.getElementById(l.options.inputId))?l.options.inputElement=e:r())}var n=function(){for(let e=0;e<o.worksheets.length;e++){var n=o.worksheets[e];if(l.options.worksheetId===p(n))return n}return null}();for(let e=0;e<l.options.fieldsRequired.length;e++){var t=l.options.fieldsRequired[e];parseInt(t)+""!=t+""||(t=n.options.columns[parseInt(t)].name)&&(l.options.fieldsRequired[e]=t)}}(),s(n)):"onchange"==e&&(null==l.options.worksheetId||"string"==typeof l.options.worksheetId&&p(n)==l.options.worksheetId||Array.isArray(l.options.worksheetId)&&p(n)in l.options.worksheetId)&&s(n.parent)},l}});
var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.jss_syncInput=n()}(this,function(){return function(t,e,n){var d={};d.options=Object.assign({},e);var o,i={inputElement:null,inputId:null,checkRow:null,fieldsRequired:[],processedValues:!0,worksheetId:null};for(o in null==d.options&&(d.options={}),i)d.options.hasOwnProperty(o)&&null!=d.options[o]||(d.options[o]=i[o]);d.onevent=function(e,n){"onchange"==e&&l(n)===d.options.worksheetId&&r(n)},d.init=function(e){null==d.options.worksheetId&&(d.options.worksheetId=l(e))};var s=n.onload;function r(e){if(null!=e){var n=e.getJson(!1,d.options.processedValues);if(1==n.length){var t=!0;for(i in n[0])if(n[0][i]){t=!1;break}t&&(n=[[]])}for(var o=[],i=0;i<n.length;i++){var s=n[i];if((!Array.isArray(s)||""!==s.join(""))&&(Array.isArray(s)||""!==Object.values(s).join(""))){for(var r=!0,u=0;u<d.options.fieldsRequired.length;u++){var p=d.options.fieldsRequired[u];if(null==s[p]||""==s[p]){r=!1;break}}(r=r&&("function"==typeof d.options.checkRow?d.options.checkRow(s,e,i):r))&&o.push(s)}}d.options.inputElement.value=JSON.stringify(o)}}function u(){d.options.inputId||!function e(n){null==n&&(n="");t.el.id?d.options.inputId=t.el.id+"_DATA"+n:d.options.inputId="JSS_DATA"+n;document.getElementById(d.options.inputId)&&(""==n&&(n=0),e(parseInt(n)+1))}();var e=d.options.inputId,n=document.createElement("input");n.id=e,n.name=e,n.type="hidden",t.el.append(n),d.options.inputElement=n}function p(){for(var e=0;e<t.worksheets.length;e++){var n=t.worksheets[e];if(d.options.worksheetId===l(n))return n}return null}function l(e){var n=e.options.worksheetId;return""===n&&(n=jSuites.guid(),e.options.worksheetId=n),n}return n.onload=function(){s&&s.apply(t,arguments),function(){{var e;d.options.inputElement||(d.options.inputId&&(e=document.getElementById(d.options.inputId))?d.options.inputElement=e:u())}for(var n=p(),t=0;t<d.options.fieldsRequired.length;t++){var o=d.options.fieldsRequired[t];parseInt(o)+""!=o+""||(o=n.options.columns[parseInt(o)].name)&&(d.options.fieldsRequired[t]=o)}}(),r(p())},d}});
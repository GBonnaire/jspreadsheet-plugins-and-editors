var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet-pro")),function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.jss_syncInput=n()}(this,function(){return function(o,e,n){var d={};d.options=Object.assign({},e);var t,i={inputElement:null,inputId:null,checkRow:null,fieldsRequired:[],processedValues:!0,worksheetId:null};for(t in null==d.options&&(d.options={}),i)d.options.hasOwnProperty(t)&&null!=d.options[t]||(d.options[t]=i[t]);d.onevent=function(e,n){"onchange"==e&&l(n)===d.options.worksheetId&&r(n)},d.init=function(e){null==d.options.worksheetId&&(d.options.worksheetId=l(e))};var s=n.onload;function r(e){if(null!=e){var n=e.getJson(!1,d.options.processedValues);if(1==n.length){var o=!0;for(i in n[0])if(n[0][i]){o=!1;break}o&&(n=[[]])}for(var t=[],i=0;i<n.length;i++){var s=n[i];if((!Array.isArray(s)||""!==s.join(""))&&(Array.isArray(s)||""!==Object.values(s).join(""))){for(var r=!0,u=0;u<d.options.fieldsRequired.length;u++){var p=d.options.fieldsRequired[u];if(null==s[p]||""==s[p]){r=!1;break}}(r=r&&("function"==typeof d.options.checkRow?d.options.checkRow(s,e,i):r))&&t.push(s)}}d.options.inputElement.value=JSON.stringify(t)}}function u(){d.options.inputId||!function e(n){null==n&&(n="");o.el.id?d.options.inputId=o.el.id+"_DATA"+n:d.options.inputId="JSS_DATA"+n;document.getElementById(d.options.inputId)&&(""==n&&(n=0),e(parseInt(n)+1))}();var e=d.options.inputId,n=document.createElement("input");n.id=e,n.name=e,n.type="hidden",o.el.append(n),d.options.inputElement=n}function p(){for(var e=0;e<o.worksheets.length;e++){var n=o.worksheets[e];if(d.options.worksheetId===l(n))return n}return null}function l(e){var n=e.options.worksheetId;return""===n&&(n=jSuites.guid(),e.options.worksheetId=n),n}return n.onload=function(){s&&s.apply(o,arguments),function(){{var e;d.options.inputElement||(d.options.inputId&&(e=document.getElementById(d.options.inputId))?d.options.inputElement=e:u())}for(var n=p(),o=0;o<d.options.fieldsRequired.length;o++){var t=d.options.fieldsRequired[o];parseInt(t)+""!=t+""||(t=n.options.columns[parseInt(t)].name)&&(d.options.fieldsRequired[o]=t)}}(),r(p())},d}});
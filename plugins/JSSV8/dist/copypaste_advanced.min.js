var jspreadsheet;jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_copypaste_advanced=t()}(this,function(){return function(e,t){if(parseInt(jspreadsheet.version().version.split(".")[0])<8)return console.error('Plugin "Copy paste advanced" not compatible with jspreadsheet '+jspreadsheet.version().version+", Please use an older version of this plugin compatible. Go to https://github.com/GBonnaire/jspreadsheet-plugins-and-editors/"),{};var y={};y.options=Object.assign({},t);var s,r,n={allow_pastestyle:!0,text_paste_special:jSuites.translate("Paste special"),text_paste_only_style:jSuites.translate("Paste only format"),text_paste_only_value:jSuites.translate("Paste only value")};for(s in null==y.options&&(y.options={}),n)y.options.hasOwnProperty(s)&&null!=y.options[s]||(y.options[s]=n[s]);function h(e,t){null==t&&(t=jspreadsheet.current),"string"==typeof e&&((s=document.createElement("div")).innerHTML=e,e=s);var s=e.querySelector("table"),r={};if(s){for(var n=parseInt(jspreadsheet.current.selectedCell[0]),a=parseInt(jspreadsheet.current.selectedCell[1]),o=e.querySelector("style"),l=s.querySelectorAll("tbody tr"),p=0;p<l.length;p++)for(var i=l[p].querySelectorAll("td"),c=0;c<i.length;c++){var d=i[c];d=u(d,o?o.innerHTML:null),r[jspreadsheet.helpers.getColumnNameFromCoords(n+c,a+p)]=d}t.setStyle(r,null,null,!0)}}function u(e,t){var s;if(s=e.style.cssText?e.style.cssText+";":"",t)for(var r=0;r<e.classList.length;r++){var n=e.classList[r],n=new RegExp("\\."+n+"\\s*{([^}]+)}","gm").exec(t);n&&(s+=n=(n=n[1]).replace(/\s+/gm," "))}return s}return y.init=function(e){},y.contextMenu=function(e,t,s,r,n,a,o,l){var p,i,c=!1,d=-1;for(p in n){var u=n[p];if(u.title==jSuites.translate("Paste")){u.onclick=function(){e.selectedCell&&y.paste()},c=!0;break}u.title==jSuites.translate("Copy")&&(d=parseInt(p))}return!c&&-1!=d&&(jspreadsheet.dataCopied||navigator&&navigator.clipboard)&&(i={title:jSuites.translate("Paste"),icon:"content_paste",shortcut:"Ctrl + V",onclick:function(){e.selectedCell&&(y.options.allow_pastestyle?y.paste():y.pasteOnlyValue())}},n.splice(d+1,0,i)),y.options.allow_pastestyle&&-1!=d&&(jspreadsheet.styleCopied||navigator&&navigator.clipboard)&&(i={title:y.options.text_paste_special,submenu:[{title:y.options.text_paste_only_value,onclick:function(){e.selectedCell&&y.pasteOnlyValue()}},{title:y.options.text_paste_only_style,onclick:function(){e.selectedCell&&y.pasteOnlyStyle()}}]},n.splice(d+2,0,i)),n},y.topMenu=function(e,t,s,r){if("Edit"==e){var n,a,o=!1,l=-1;for(n in t){var p=t[n];if(p.title==jSuites.translate("Paste")){p.onclick=function(){jspreadsheet.current.selectedCell&&y.paste()},o=!0;break}p.title==jSuites.translate("Copy")&&(l=parseInt(n))}!o&&-1!=l&&(jspreadsheet.dataCopied||navigator&&navigator.clipboard)&&(a={title:jSuites.translate("Paste"),icon:"content_paste",shortcut:r+" V",onclick:function(){jspreadsheet.current.selectedCell&&(y.options.allow_pastestyle?y.paste():y.pasteOnlyValue())}},t.splice(l+1,0,a)),y.options.allow_pastestyle&&-1!=l&&(jspreadsheet.styleCopied||navigator&&navigator.clipboard)&&(a={title:y.options.text_paste_special,submenu:[{title:y.options.text_paste_only_value,onclick:function(){jspreadsheet.current.selectedCell&&y.pasteOnlyValue()}},{title:y.options.text_paste_only_style,onclick:function(){jspreadsheet.current.selectedCell&&y.pasteOnlyStyle()}}]},t.splice(l+2,0,a))}return t},y.toolbar=function(e){var t,s={type:"i",content:"content_paste",onclick:function(){jspreadsheet.current.selectedCell&&y.paste()}},r={type:"i",content:"content_cut",onclick:function(){jspreadsheet.current.selectedCell&&jspreadsheet.current.copy(!0)}},n={type:"i",content:"content_copy",onclick:function(){jspreadsheet.current.selectedCell&&jspreadsheet.current.copy()}};for(t in e.items)if("redo"==e.items[t].content){e.items.splice(parseInt(t)+1,0,s),e.items.splice(parseInt(t)+1,0,n),e.items.splice(parseInt(t)+1,0,r);break}return e},y.onevent=function(e){if("oncopy"==e){jspreadsheet.dataCopied=arguments[3];var t=arguments[1],s=arguments[2];if(y.options.allow_pastestyle&&t.options.style){for(var r=parseInt(s[0]),n=parseInt(s[1]),a=parseInt(s[2]),o=parseInt(s[3]),l=[],p=n;p<=o;p++){for(var i=[],c=r;c<=a;c++){var d=jspreadsheet.helpers.getColumnNameFromCoords(c,p);i.push(t.options.style[d])}l.push(i)}jspreadsheet.styleCopied=l}else jspreadsheet.styleCopied=null}},y.copy=function(e){if(jspreadsheet.current)return jspreadsheet.current.copy(e)},y.paste=function(s){null==s&&(s=!1);var e,r=parseInt(jspreadsheet.current.selectedCell[0]),n=parseInt(jspreadsheet.current.selectedCell[1]);navigator&&navigator.clipboard?navigator.clipboard.read().then(function(e){e[0].getType("text/plain").then(function(e){return new Response(e).text().then(function(e){var t;!s&&y.options.allow_pastestyle||(t=jspreadsheet.current.borders.copying,jspreadsheet.current.borders.copying=null),e&&jspreadsheet.current.paste(r,n,e),!s&&y.options.allow_pastestyle||(jspreadsheet.current.borders.copying=t)})}),y.options.allow_pastestyle&&!s&&e[0].getType("text/html").then(function(e){return new Response(e).text().then(function(e){h(e)})})}).catch(function(e){var t;jspreadsheet.dataCopied&&(!s&&y.options.allow_pastestyle||(t=jspreadsheet.current.borders.copying,jspreadsheet.current.borders.copying=null),jspreadsheet.current.paste(r,n,jspreadsheet.dataCopied),!s&&y.options.allow_pastestyle||(jspreadsheet.current.borders.copying=t)),y.options.allow_pastestyle&&!s&&!jspreadsheet.current.borders.copying&&jspreadsheet.styleCopied&&y.pasteOnlyStyle()}):jspreadsheet.dataCopied&&(!s&&y.options.allow_pastestyle||(e=jspreadsheet.current.borders.copying,jspreadsheet.current.borders.copying=null),jspreadsheet.current.paste(r,n,jspreadsheet.dataCopied),!s&&y.options.allow_pastestyle||(jspreadsheet.current.borders.copying=e),y.options.allow_pastestyle&&!s&&!jspreadsheet.current.borders.copying&&jspreadsheet.styleCopied&&y.pasteOnlyStyle())},y.pasteOnlyStyle=function(){var e=null;if(jspreadsheet.current.borders.copying){var t=[jspreadsheet.current.borders.copying.x1,jspreadsheet.current.borders.copying.y1,jspreadsheet.current.borders.copying.x2,jspreadsheet.current.borders.copying.y2];if(jspreadsheet.current.options.style){for(var s=parseInt(t[0]),r=parseInt(t[1]),n=parseInt(t[2]),a=parseInt(t[3]),o=[],l=r;l<=a;l++){for(var p=[],i=s;i<=n;i++){var c=jspreadsheet.helpers.getColumnNameFromCoords(i,l);p.push(jspreadsheet.current.options.style[c])}o.push(p)}e=o}}else navigator&&navigator.clipboard?navigator.clipboard.read().then(function(e){e[0].getType("text/html").then(function(e){return new Response(e).text().then(function(e){h(e)})})}):e=jspreadsheet.styleCopied;if(e){for(var i=parseInt(jspreadsheet.current.selectedCell[0]),l=parseInt(jspreadsheet.current.selectedCell[1]),d={},u=0;u<e.length;u++)for(var p=e[u],y=0;y<p.length;y++){o=p[y];d[c=jspreadsheet.helpers.getColumnNameFromCoords(i+y,l+u)]=o}jspreadsheet.current.setStyle(d,null,null,!0)}},y.pasteOnlyValue=function(){y.paste(!0)},y.options.allow_pastestyle&&(r=jspreadsheet.events.paste,jspreadsheet.pasteControls=function(e){r(e),jspreadsheet.current&&jspreadsheet.current.selectedCell&&(jspreadsheet.current.edition||(e&&e.clipboardData&&e.clipboardData.types&&e.clipboardData.getData?(e.clipboardData.types instanceof DOMStringList&&e.clipboardData.types.contains("text/html")||e.clipboardData.types.indexOf&&-1!==e.clipboardData.types.indexOf("text/html"))&&h(e.clipboardData.getData("text/html")):window.clipboardData&&window.clipboardData.types&&window.clipboardData.getData&&(window.clipboardData.types instanceof DOMStringList&&window.clipboardData.types.contains("text/html")||window.clipboardData.types.indexOf&&-1!==window.clipboardData.types.indexOf("text/html"))&&h(window.clipboardData.getData("text/html"))))}),y}});
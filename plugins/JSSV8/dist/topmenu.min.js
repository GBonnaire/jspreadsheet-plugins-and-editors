var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_topmenu=t()}(this,function(){return function(i,e,t){let p="Ctrl +";/(MacPPC|MacIntel|Mac_PowerPC|Macintosh|Mac OS X)/.test(window.navigator.userAgent)&&(p="âŒ˜ +");const d={};d.options=Object.assign({},e),d.topmenu=null,d.menus=[];let n=null,r=null,u=null,c=!1;var s,l={text_file:jSuites.translate("File"),text_edit:jSuites.translate("Edit"),text_view:jSuites.translate("View"),text_item_rename:jSuites.translate("Rename"),text_item_insert:jSuites.translate("Insert"),text_item_delete:jSuites.translate("Delete"),text_item_newworksheet:jSuites.translate("New worksheet"),text_item_fullscreenexit:jSuites.translate("Exit fullscreen"),text_item_fullscreenenter:jSuites.translate("Enter fullscreen"),text_item_resetfilters:jSuites.translate("Reset filter(s)"),menus:{File:function(e,t,n){let s=[],l=e.tabs.headers.querySelector(".jtabs-selected"),o=i.getWorksheetActive();e=Array.isArray(e.jspreadsheet)?e.jspreadsheet.length:1;return 0!=i.config.tabs&&1==i.config.tabs.allowCreate&&(s.push({icon:"tab",disabled:!t.options.editable,title:d.options.text_item_newworksheet,onclick:function(){t.createWorksheet()}}),l&&1==i.config.allowRenameWorksheet&&s.push({icon:"edit",disabled:!t.options.editable,title:jSuites.translate("Rename this worksheet")+` (${l.innerText})`,onclick:function(){var e;null==l||(e=prompt(jSuites.translate("Rename this worksheet"),l.innerText))&&i.renameWorksheet(o,e)}}),l&&1==i.config.allowDeleteWorksheet&&1<e&&s.push({icon:"tab_unselected",disabled:!t.options.editable,title:jSuites.translate("Delete this worksheet")+` (${l.innerText})`,onclick:function(){null!=l&&confirm(jSuites.translate("Are you sure to delete this worksheet?"),l.innerText)&&i.deleteWorksheet(o)}}),s.push({type:"line"})),1==i.config.allowExport&&(s.push({icon:"save",title:jSuites.translate("Save as")+" CSV",shortcut:p+" S",onclick:function(){t.download()}}),s.push({type:"line"})),i.config.about&&s.push({icon:"info",title:jSuites.translate("About"),onclick:function(){!0===i.config.about?alert(jspreadsheet.version(!0)):alert(i.config.about)}}),s},Edit:function(e,r,t){let u=[];if(u.push({icon:"undo",title:jSuites.translate("Undo"),disabled:!r.options.editable,shortcut:p+" Z",onclick:function(){(jspreadsheet.current||r).undo()}}),u.push({icon:"redo",title:jSuites.translate("Redo"),disabled:!r.options.editable,shortcut:p+" Y",onclick:function(){(jspreadsheet.current||r).redo()}}),u.push({type:"line"}),u.push({icon:"content_cut",title:jSuites.translate("Cut"),shortcut:p+" X",onclick:function(){(jspreadsheet.current||r).copy(!0)}}),u.push({icon:"content_copy",title:jSuites.translate("Copy"),shortcut:p+" C",onclick:function(){(jspreadsheet.current||r).copy()}}),navigator&&navigator.clipboard&&navigator.clipboard.readText&&u.push({icon:"content_paste",title:jSuites.translate("Paste"),disabled:!r.options.editable,shortcut:p+" V",onclick:function(){r.selectedCell&&navigator.clipboard.readText().then(function(e){e&&jspreadsheet.current.paste(r.selectedCell[0],r.selectedCell[1],e)})}}),null!=r.selectedCell){u.push({type:"line"});let e=[],t=[],n=[],s=jspreadsheet.helpers.getColumnNameFromCoords(r.selectedCell[0],r.selectedCell[1]),l=jspreadsheet.helpers.getColumnNameFromCoords(r.selectedCell[2],r.selectedCell[3]);var c=s.substring(0,s.length-(""+(+r.selectedCell[1]+1)).length),a=l.substring(0,l.length-(""+(+r.selectedCell[3]+1)).length);let o;o=c!=a?`${c} - ${a}`:c,1==r.options.allowInsertColumn&&(e.push({title:jSuites.translate("Insert a new column before")+` (${c})`,onclick:function(){r.insertColumn(1,parseInt(r.selectedCell[0]),1)}}),e.push({title:jSuites.translate("Insert a new column after")+` (${c})`,onclick:function(){r.insertColumn(1,parseInt(r.selectedCell[0]),0)}})),1==r.options.allowDeleteColumn&&t.push({title:jSuites.translate("Delete selected columns")+` (${o})`,disabled:!r.options.editable,onclick:function(){r.deleteColumn(r.getSelectedColumns().length?void 0:parseInt(r.selectedCell[0]))}}),1==r.options.allowRenameColumn&&n.push({title:jSuites.translate("Rename this column")+` (${c})`,onclick:function(){r.setHeader(parseInt(r.selectedCell[0]))}});a=+r.selectedCell[1]+1,c=+r.selectedCell[3]+1;let i;i=a!=c?`${a} - ${c}`:a,1==r.options.allowInsertRow&&(e.push({title:jSuites.translate("Insert a new row before")+` (${a})`,onclick:function(){r.insertRow(1,parseInt(r.selectedCell[1]),1)}}),e.push({title:jSuites.translate("Insert a new row after")+` (${a})`,onclick:function(){r.insertRow(1,parseInt(r.selectedCell[1]))}})),1==r.options.allowDeleteRow&&t.push({title:jSuites.translate("Delete selected rows")+` (${i})`,disabled:!r.options.editable,onclick:function(){r.deleteRow(r.getSelectedRows().length?void 0:parseInt(r.selectedCell[1]))}}),0<e.length&&u.push({title:d.options.text_item_insert,icon:"add",submenu:e}),0<t.length&&u.push({title:d.options.text_item_delete,icon:"remove",submenu:t}),0<n.length&&u.push({title:d.options.text_item_rename,icon:"edit",submenu:n})}return u},View:function(e,t,n){let s=[];if(e.classList.contains("fullscreen")?s.push({icon:"fullscreen_exit",title:d.options.text_item_fullscreenexit,onclick:function(){m().fullscreen(!1)}}):s.push({icon:"fullscreen",title:d.options.text_item_fullscreenenter,onclick:function(){m().fullscreen(!0)}}),null!=t.selectedCell){const l=jspreadsheet.helpers.getColumnNameFromCoords(t.selectedCell[0],t.selectedCell[1]);e=l.substring(0,l.length-(""+(+t.selectedCell[1]+1)).length);1==t.options.columnSorting&&(s.push({type:"line"}),s.push({title:jSuites.translate("Order ascending")+` (${e})`,onclick:function(){t.orderBy(parseInt(t.selectedCell[0]),0)}}),s.push({title:jSuites.translate("Order descending")+` (${e})`,onclick:function(){t.orderBy(parseInt(t.selectedCell[0]),1)}}))}return 1==t.options.filters&&(s.push({type:"line"}),s.push({title:d.options.text_item_resetfilters,onclick:function(){t.resetFilters()}})),s}}};for(s in null==d.options&&(d.options={}),l)d.options.hasOwnProperty(s)&&null!=d.options[s]||(d.options[s]=l[s]);function o(e,t){return t==e||t!=document&&o(e,t.parentNode)}function a(){for(let e=0;e<d.menus.length;e++){var t=d.menus[e];const n=document.createElement("BUTTON");switch(t.name){case"File":n.innerHTML=d.options.text_file;break;case"Edit":n.innerHTML=d.options.text_edit;break;case"View":n.innerHTML=d.options.text_view;break;default:n.innerHTML=t.name}n.addEventListener("click",function(l,o){return function(e){if(c&&this==u)f();else{c=!0,function(e){null!=u&&h(u);e.classList.add("active"),u=e}(this);var n,s=e.target.getBoundingClientRect(),s={x:s.left,y:s.top+s.height};let t;for(n in t="function"==typeof l?l(i.el,m(),this):l.slice(),i.plugins){let e=i.plugins[n];e.topMenu&&"function"==typeof e.topMenu&&(t=e.topMenu(o,t,this,p))}r.open(s,t),e.preventDefault(),e.stopPropagation()}}}(t.items,t.name)),n.addEventListener("mouseover",function(e){c&&e.target!=u&&this.dispatchEvent(new Event("click"))}),d.topmenu.append(n)}}function h(e){u==e&&(u=null),null!=e&&(e.classList.remove("active"),r.close())}function f(){r.close(),h(u),c=!1}function m(){return jspreadsheet.current||(null!=i.getWorksheetActive()?i.worksheets[i.getWorksheetActive()]:i.worksheets[0])}return d.onevent=function(e,t){"onload"==e&&(i.tools.insertBefore(d.topmenu,i.tools.firstChild),n=document.createElement("DIV"),n.className="jss_contextmenu",r=jSuites.contextmenu(n,{onclick:function(){f()}}),i.el.append(n))},d.contextMenu=function(e,t,n,s,l){return o(d.topmenu,s.target)?[]:l},d.add=function(e,t,n){null!=d.topmenu?(null==t&&(t=[]),null!=n?d.menus.splice(n,0,{name:e,items:t}):d.menus.push({name:e,items:t}),d.refresh()):console.error("Topmenu bar is not loaded")},i.addTopmenu=d.add,d.refresh=function(){d.topmenu.innerHTML="",a()},function(){for(var e in d.options.menus)d.menus.push({name:e,items:d.options.menus[e]})}(),d.topmenu=document.createElement("DIV"),d.topmenu.classList.add("jss-topmenu"),d.topmenu.classList.add("jexcel_object"),a(),document.addEventListener("keydown",function(e){27==e.which&&1==c&&(f(),e.preventDefault(),e.stopPropagation())}),document.addEventListener("click",function(e){!c||o(d.topmenu,e.target)&&e.target!=d.topmenu||(f(),e.preventDefault(),e.stopPropagation())}),d}});
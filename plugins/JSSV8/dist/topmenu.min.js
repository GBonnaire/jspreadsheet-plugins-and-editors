var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet-pro")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_topmenu=t()}(this,function(){return function(r,e,t){var a="Ctrl +";/(MacPPC|MacIntel|Mac_PowerPC|Macintosh|Mac OS X)/.test(window.navigator.userAgent)&&(a="âŒ˜ +");var c={};c.options=Object.assign({},e),c.topmenu=null,c.menus=[];var n,s=null,u=null,p=null,d=!1,l={text_file:jSuites.translate("File"),text_edit:jSuites.translate("Edit"),text_view:jSuites.translate("View"),text_item_rename:jSuites.translate("Rename"),text_item_insert:jSuites.translate("Insert"),text_item_delete:jSuites.translate("Delete"),text_item_newworksheet:jSuites.translate("New worksheet"),text_item_fullscreenexit:jSuites.translate("Exit fullscreen"),text_item_fullscreenenter:jSuites.translate("Enter fullscreen"),text_item_resetfilters:jSuites.translate("Reset filter(s)"),menus:{File:function(e,t,n){var s=[],l=e.querySelector(".jtabs-selected"),o=r.getWorksheetActive(),e=Array.isArray(e.jspreadsheet)?e.jspreadsheet.length:1;return 1==r.config.tabs&&(s.push({icon:"tab",disabled:!t.options.editable,title:c.options.text_item_newworksheet,onclick:function(){t.createWorksheet()}}),1==r.config.allowRenameWorksheet&&s.push({icon:"edit",disabled:!t.options.editable,title:jSuites.translate("Rename this worksheet")+` (${l.innerText})`,onclick:function(){var e;null==l||(e=prompt(jSuites.translate("Rename this worksheet"),l.innerText))&&r.renameWorksheet(o,e)}}),1==r.config.allowDeleteWorksheet&&1<e&&s.push({icon:"tab_unselected",disabled:!t.options.editable,title:jSuites.translate("Delete this worksheet")+` (${l.innerText})`,onclick:function(){null!=l&&confirm(jSuites.translate("Are you sure to delete this worksheet?"),l.innerText)&&r.deleteWorksheet(l)}}),s.push({type:"line"})),1==r.config.allowExport&&(s.push({icon:"save",title:jSuites.translate("Save as")+" CSV",shortcut:a+" S",onclick:function(){t.download()}}),s.push({type:"line"})),r.config.about&&s.push({icon:"info",title:jSuites.translate("About"),onclick:function(){!0===r.config.about?alert(jspreadsheet.version(!0)):alert(r.config.about)}}),s},Edit:function(e,t,n){var s,l,o,i,r,u=[];return u.push({icon:"undo",title:jSuites.translate("Undo"),disabled:!t.options.editable,shortcut:a+" Z",onclick:function(){(jspreadsheet.current||t).undo()}}),u.push({icon:"redo",title:jSuites.translate("Redo"),disabled:!t.options.editable,shortcut:a+" Y",onclick:function(){(jspreadsheet.current||t).redo()}}),u.push({type:"line"}),u.push({icon:"content_cut",title:jSuites.translate("Cut"),shortcut:a+" X",onclick:function(){(jspreadsheet.current||t).copy(!0)}}),u.push({icon:"content_copy",title:jSuites.translate("Copy"),shortcut:a+" C",onclick:function(){(jspreadsheet.current||t).copy()}}),navigator&&navigator.clipboard&&navigator.clipboard.readText&&u.push({icon:"content_paste",title:jSuites.translate("Paste"),disabled:!t.options.editable,shortcut:a+" V",onclick:function(){t.selectedCell&&navigator.clipboard.readText().then(function(e){e&&jspreadsheet.current.paste(t.selectedCell[0],t.selectedCell[1],e)})}}),null!=t.selectedCell&&(u.push({type:"line"}),s=[],l=[],o=[],r=jspreadsheet.helpers.getColumnNameFromCoords(t.selectedCell[0],t.selectedCell[1]),i=jspreadsheet.helpers.getColumnNameFromCoords(t.selectedCell[2],t.selectedCell[3]),i=(r=r.substring(0,r.length-(""+(+t.selectedCell[1]+1)).length))!=(i=i.substring(0,i.length-(""+(+t.selectedCell[3]+1)).length))?`${r} - ${i}`:r,1==t.options.allowInsertColumn&&(s.push({title:jSuites.translate("Insert a new column before")+` (${r})`,onclick:function(){t.insertColumn(1,parseInt(t.selectedCell[0]),1)}}),s.push({title:jSuites.translate("Insert a new column after")+` (${r})`,onclick:function(){t.insertColumn(1,parseInt(t.selectedCell[0]),0)}})),1==t.options.allowDeleteColumn&&l.push({title:jSuites.translate("Delete selected columns")+` (${i})`,disabled:!t.options.editable,onclick:function(){t.deleteColumn(t.getSelectedColumns().length?void 0:parseInt(t.selectedCell[0]))}}),1==t.options.allowRenameColumn&&o.push({title:jSuites.translate("Rename this column")+` (${r})`,onclick:function(){t.setHeader(parseInt(t.selectedCell[0]))}}),r=(i=+t.selectedCell[1]+1)!=(r=+t.selectedCell[3]+1)?`${i} - ${r}`:i,1==t.options.allowInsertRow&&(s.push({title:jSuites.translate("Insert a new row before")+` (${i})`,onclick:function(){t.insertRow(1,parseInt(t.selectedCell[1]),1)}}),s.push({title:jSuites.translate("Insert a new row after")+` (${i})`,onclick:function(){t.insertRow(1,parseInt(t.selectedCell[1]))}})),1==t.options.allowDeleteRow&&l.push({title:jSuites.translate("Delete selected rows")+` (${r})`,disabled:!t.options.editable,onclick:function(){t.deleteRow(t.getSelectedRows().length?void 0:parseInt(t.selectedCell[1]))}}),0<s.length&&u.push({title:c.options.text_item_insert,icon:"add",submenu:s}),0<l.length&&u.push({title:c.options.text_item_delete,icon:"remove",submenu:l}),0<o.length&&u.push({title:c.options.text_item_rename,icon:"edit",submenu:o})),u},View:function(e,t,n){var s=[];return e.classList.contains("fullscreen")?s.push({icon:"fullscreen_exit",title:c.options.text_item_fullscreenexit,onclick:function(){j().fullscreen(!1)}}):s.push({icon:"fullscreen",title:c.options.text_item_fullscreenenter,onclick:function(){j().fullscreen(!0)}}),null!=t.selectedCell&&(e=jspreadsheet.helpers.getColumnNameFromCoords(t.selectedCell[0],t.selectedCell[1]),jspreadsheet.helpers.getColumnNameFromCoords(t.selectedCell[2],t.selectedCell[3]),e=e.substring(0,e.length-(""+(+t.selectedCell[1]+1)).length),1==t.options.columnSorting&&(s.push({type:"line"}),s.push({title:jSuites.translate("Order ascending")+` (${e})`,onclick:function(){t.orderBy(parseInt(t.selectedCell[0]),0)}}),s.push({title:jSuites.translate("Order descending")+` (${e})`,onclick:function(){t.orderBy(parseInt(t.selectedCell[0]),1)}}))),1==t.options.filters&&(s.push({type:"line"}),s.push({title:c.options.text_item_resetfilters,onclick:function(){t.resetFilters()}})),s}}};for(n in null==c.options&&(c.options={}),l)c.options.hasOwnProperty(n)&&null!=c.options[n]||(c.options[n]=l[n]);var o=t.onload;function i(e,t){return t==e||t!=document&&i(e,t.parentNode)}function h(){for(var e=0;e<c.menus.length;e++){var t=c.menus[e],n=document.createElement("BUTTON");switch(t.name){case"File":n.innerHTML=c.options.text_file;break;case"Edit":n.innerHTML=c.options.text_edit;break;case"View":n.innerHTML=c.options.text_view;break;default:n.innerHTML=t.name}n.addEventListener("click",function(o,i){return function(e){if(d&&this==p)m();else{d=!0,function(e){null!=p&&f(p);e.classList.add("active"),p=e}(this);var t,n,s=e.target.getBoundingClientRect(),s={x:s.left,y:s.top+s.height};for(n in t="function"==typeof o?o(r.el,j(),this):o.slice(),r.plugins){var l=r.plugins[n];l.topMenu&&"function"==typeof l.topMenu&&(t=l.topMenu(i,t,this,a))}u.open(s,t),e.preventDefault(),e.stopPropagation()}}}(t.items,t.name)),n.addEventListener("mouseover",function(e){d&&e.target!=p&&this.dispatchEvent(new Event("click"))}),c.topmenu.append(n)}}function f(e){p==e&&(p=null),null!=e&&(e.classList.remove("active"),u.close())}function m(){u.close(),f(p),d=!1}function j(){return jspreadsheet.current||(null!=r.getWorksheetActive()?r.worksheets[r.getWorksheetActive()]:r.worksheets[0])}return t.onload=function(){o&&o.apply(r,arguments),r.tools.insertBefore(c.topmenu,r.tools.firstChild),(s=document.createElement("DIV")).className="jexcel_contextmenu",u=jSuites.contextmenu(s,{onclick:function(){m()}}),r.el.append(s)},c.contextMenu=function(e,t,n,s,l){return i(c.topmenu,s.target)?[]:l},c.add=function(e,t,n){null!=c.topmenu?(null==t&&(t=[]),null!=n?c.menus.splice(n,0,{name:e,items:t}):c.menus.push({name:e,items:t}),c.refresh()):console.error("Topmenu bar is not loaded")},r.addTopmenu=c.add,c.refresh=function(){c.topmenu.innerHTML="",h()},function(){for(var e in c.options.menus)c.menus.push({name:e,items:c.options.menus[e]})}(),c.topmenu=document.createElement("DIV"),c.topmenu.classList.add("jss-topmenu"),c.topmenu.classList.add("jexcel_object"),h(),document.addEventListener("keydown",function(e){27==e.which&&1==d&&(m(),e.preventDefault(),e.stopPropagation())}),document.addEventListener("click",function(e){!d||i(c.topmenu,e.target)&&e.target!=c.topmenu||(m(),e.preventDefault(),e.stopPropagation())}),c}});
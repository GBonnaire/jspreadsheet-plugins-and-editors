!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.jss_contextmenu_rowAdvancedActions=e(),t.jexcel_contextmenu_rowAdvancedActions=t.jss_contextmenu_rowAdvancedActions}(this,function(){return function(s,t){var p={};p.options=Object.assign({},t);var e,o,n={icon_moveup:"arrow_upward",icon_movedown:"arrow_downward",icon_duplicate:"content_copy",text_moveup:"Move up row(s) selected",text_movedown:"Move down row(s) selected",text_duplicate:"Duplicate row(s) selected"};for(e in null==p.options&&(p.options={}),n)p.options.hasOwnProperty(e)&&null!=p.options[e]||(p.options[e]=n[e]),"text_"===e.substring(0,5)&&(o="contextmenurowsadvancedactions_"+e.substring(5,e.length),s.options.text[o]&&(p.options[e]=s.options.text[o]));return p.contextMenu=function(n,t,e,o,i){if(null==t&&n.getSelectedRows().length){var a,r=0;for(a in i)if("divisor"==i[a].type||"line"==i[a].type){r=parseInt(a)+1;break}s.options.rowDrag&&(c={title:p.options.text_moveup,onclick:function(){var t=n.getSelectedRows();t.forEach(function(t){t=parseInt(t.getAttribute("data-y"));n.moveRow(t,t-1)});var e=parseInt(t[0].getAttribute("data-y")),o=n.options.data[0].length-1,t=parseInt(t[t.length-1].getAttribute("data-y"));n.updateSelectionFromCoords(0,e,o,t)}},p.options.icon_moveup&&(c.icon=p.options.icon_moveup),i.splice(r,0,c),r++,c={title:p.options.text_movedown,onclick:function(){var t=n.getSelectedRows();t.reverse().forEach(function(t){t=parseInt(t.getAttribute("data-y"));n.moveRow(t,t+1)});var e=parseInt(t[0].getAttribute("data-y")),o=n.options.data[0].length-1,t=parseInt(t[t.length-1].getAttribute("data-y"));n.updateSelectionFromCoords(0,e,o,t)}},p.options.icon_movedown&&(c.icon=p.options.icon_movedown),i.splice(r,0,c),r++);var c={title:p.options.text_duplicate,onclick:function(){var t=n.getSelectedRows(),e=parseInt(t[t.length-1].getAttribute("data-y"));n.getData(!0).forEach(function(t){n.insertRow(t,e),e++});var o=parseInt(t[0].getAttribute("data-y")),t=n.options.data[0].length-1;n.updateSelectionFromCoords(0,o,t,e)}};p.options.icon_duplicate&&(c.icon=p.options.icon_duplicate),i.splice(r,0,c),i.splice(++r,0,{type:"line"})}return i},p.topMenu=function(t,e,o,n){var i,a;return"Edit"!=t||null!=(i=s).selectedCell&&(e.push({type:"line"}),s.options.rowDrag&&(a={title:p.options.text_moveup,onclick:function(){var t=i.getSelectedRows();t.forEach(function(t){t=parseInt(t.getAttribute("data-y"));i.moveRow(t,t-1)});var e=parseInt(t[0].getAttribute("data-y")),o=i.options.data[0].length-1,t=parseInt(t[t.length-1].getAttribute("data-y"));i.updateSelectionFromCoords(0,e,o,t)}},p.options.icon_moveup&&(a.icon=p.options.icon_moveup),e.push(a),a={title:p.options.text_movedown,onclick:function(){var t=i.getSelectedRows();t.reverse().forEach(function(t){t=parseInt(t.getAttribute("data-y"));i.moveRow(t,t+1)});var e=parseInt(t[0].getAttribute("data-y")),o=i.options.data[0].length-1,t=parseInt(t[t.length-1].getAttribute("data-y"));i.updateSelectionFromCoords(0,e,o,t)}},p.options.icon_movedown&&(a.icon=p.options.icon_movedown),e.push(a)),a={title:p.options.text_duplicate,onclick:function(){var t=i.getSelectedRows(),e=parseInt(t[t.length-1].getAttribute("data-y"));i.getData(!0).forEach(function(t){i.insertRow(t,e),e++});var o=parseInt(t[0].getAttribute("data-y")),t=i.options.data[0].length-1;i.updateSelectionFromCoords(0,o,t,e)}},p.options.icon_duplicate&&(a.icon=p.options.icon_duplicate),e.push(a)),e},p}});
var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet-pro")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_topmenu=t()}(this,function(){return function(c,e){var u="Ctrl +";/(MacPPC|MacIntel|Mac_PowerPC|Macintosh|Mac OS X)/.test(window.navigator.userAgent)&&(u="âŒ˜ +");var o={};o.options=Object.assign({},e),o.topmenu=null,o.menus=[];var t,n,i=null,r=null,a=null,p=!1,s={text_file:"File",text_edit:"Edit",text_view:"View",menus:{File:function(e,t,n){var o=[];return 1==t.options.allowExport&&o.push({icon:"save",title:c.options.text.saveAs+" CSV",shortcut:u+" S",onclick:function(){c.download()}}),o},Edit:function(e,t,n){var o,i,s,l,c=[];return c.push({icon:"undo",title:t.options.text.undo||"Undo",disabled:!t.options.editable,shortcut:u+" Z",onclick:function(){(jspreadsheet.current||t).undo()}}),c.push({icon:"redo",title:t.options.text.redo||"Redo",disabled:!t.options.editable,shortcut:u+" Y",onclick:function(){(jspreadsheet.current||t).redo()}}),c.push({type:"line"}),c.push({icon:"content_cut",title:t.options.text.cut,shortcut:u+" X",onclick:function(){(jspreadsheet.current||t).copy(!0)}}),c.push({icon:"content_copy",title:t.options.text.copy,shortcut:u+" C",onclick:function(){(jspreadsheet.current||t).copy()}}),navigator&&navigator.clipboard&&navigator.clipboard.readText&&c.push({icon:"content_paste",title:t.options.text.paste,disabled:!t.options.editable,shortcut:u+" V",onclick:function(){t.selectedCell&&navigator.clipboard.readText().then(function(e){e&&jspreadsheet.current.paste(t.selectedCell[0],t.selectedCell[1],e)})}}),null!=t.selectedCell&&(c.push({type:"line"}),o=jspreadsheet.getColumnNameFromId([t.selectedCell[0],t.selectedCell[1]]),i=jspreadsheet.getColumnNameFromId([t.selectedCell[2],t.selectedCell[3]]),1==t.options.allowDeleteColumn&&(l=o.substring(0,o.length-(""+t.selectedCell[1]).length),s=i.substring(0,i.length-(""+t.selectedCell[3]).length),c.push({title:t.options.text.deleteSelectedColumns+` (${l!=s?`${l} - ${s}`:l})`,disabled:!t.options.editable,onclick:function(){t.deleteColumn(t.getSelectedColumns().length?void 0:parseInt(t.selectedCell[0]))}})),1==t.options.allowDeleteRow&&(s=+t.selectedCell[1]+1,l=+t.selectedCell[3]+1,c.push({title:t.options.text.deleteSelectedRows+` (${s!=l?`${s} - ${l}`:s})`,disabled:!t.options.editable,onclick:function(){t.deleteRow(t.getSelectedRows().length?void 0:parseInt(t.selectedCell[1]))}}))),c},View:function(e,t,n){var o=[];return e.classList.contains("fullscreen")?o.push({icon:"fullscreen_exit",title:"Exit fullscreen",onclick:function(){c.fullscreen(!1)}}):o.push({icon:"fullscreen",title:"Enter fullscreen",onclick:function(){c.fullscreen(!0)}}),o}}};for(t in null==o.options&&(o.options={}),s)o.options.hasOwnProperty(t)&&null!=o.options[t]||(o.options[t]=s[t]),"text_"===t.substring(0,5)&&(n="topmenu_"+t.substring(5,t.length),c.options.text[n]&&(o.options[t]=c.options.text[n]));function l(){for(var e=0;e<o.menus.length;e++){var t=o.menus[e],n=document.createElement("BUTTON");switch(t.name){case"File":n.innerHTML=o.options.text_file;break;case"Edit":n.innerHTML=o.options.text_edit;break;case"View":n.innerHTML=o.options.text_view;break;default:n.innerHTML=t.name}n.addEventListener("click",function(s,l){return function(e){if(p&&this==a)f();else{p=!0,function(e){null!=a&&d(a);e.classList.add("active"),a=e}(this);var t,n,o=e.target.getBoundingClientRect(),o={x:o.left,y:o.top+o.height};for(n in t="function"==typeof s?s(c.el,c,this):s.slice(),c.plugins){var i=c.plugins[n];i.topMenu&&"function"==typeof i.topMenu&&(t=i.topMenu(l,t,this,u))}r.open(o,t),e.preventDefault(),e.stopPropagation()}}}(t.items,t.name)),n.addEventListener("mouseover",function(e){p&&this.dispatchEvent(new Event("click"))}),o.topmenu.append(n)}}function d(e){a==e&&(a=null),null!=e&&(e.classList.remove("active"),r.close())}function f(){r.close(),d(a),p=!1}return o.onevent=function(e){"onload"==e&&(c.worksheet.insertBefore(o.topmenu,c.worksheet.firstChild),(i=document.createElement("DIV")).className="jexcel_contextmenu",r=jSuites.contextmenu(i,{onclick:function(){f()}}),c.el.append(i))},o.add=function(e,t,n){null!=o.topmenu?(null==t&&(t=[]),null!=n?o.menus.splice(n,0,{name:e,items:t}):o.menus.push({name:e,items:t}),o.refresh()):console.error("Topmenu bar is not loaded")},c.addTopmenu=o.add,o.refresh=function(){o.topmenu.innerHTML="",l()},function(){for(var e in o.options.menus)o.menus.push({name:e,items:o.options.menus[e]})}(),o.topmenu=document.createElement("DIV"),o.topmenu.classList.add("jss-topmenu"),o.topmenu.classList.add("jexcel_object"),l(),document.addEventListener("keydown",function(e){27==e.which&&(f(),e.preventDefault(),e.stopPropagation())}),document.addEventListener("click",function(e){(function e(t,n){if(n==t)return!0;if(n==document)return!1;return e(t,n.parentNode)})(o.topmenu,e.target)&&e.target!=o.topmenu||(f(),e.preventDefault(),e.stopPropagation())}),o}});
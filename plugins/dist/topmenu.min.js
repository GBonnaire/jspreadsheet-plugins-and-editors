var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet-pro")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_topmenu=t()}(this,function(){return function(r,e){var u="Ctrl +";/(MacPPC|MacIntel|Mac_PowerPC|Macintosh|Mac OS X)/.test(window.navigator.userAgent)&&(u="âŒ˜ +");var p={};p.options=Object.assign({},e),p.topmenu=null,p.menus=[];var t,n,o=null,c=null,a=null,d=!1,i={text_file:"File",text_edit:"Edit",text_view:"View",text_item_rename:"Raname",text_item_insert:"Insert",text_item_delete:"Delete",text_item_newworksheet:"New worksheet",text_item_fullscreenexit:"Exit fullscreen",text_item_fullscreenenter:"Enter fullscreen",text_item_resetfilters:"Reset filter(s)",menus:{File:function(e,t,n){var o,i=[],s=e.querySelector(".jtabs-selected"),l=Array.isArray(e.jspreadsheet)?e.jspreadsheet.length:1;return 1==(o=1==l?t:e.jspreadsheet[0]).options.tabs&&(i.push({icon:"tab",disabled:!t.options.editable,title:p.options.text_item_newworksheet,onclick:function(){t.createWorksheet()}}),1==o.options.allowRenameWorksheet&&i.push({icon:"edit",disabled:!t.options.editable,title:t.options.text.renameThisWorksheet+` (${s.innerText})`,onclick:function(){var e;null==s||(e=prompt(t.options.text.renameThisWorksheet,s.innerText))&&o.renameWorksheet(s,e)}}),1==o.options.allowDeleteWorksheet&&1<l&&i.push({icon:"tab_unselected",disabled:!t.options.editable,title:t.options.text.deleteThisWorksheet+` (${s.innerText})`,onclick:function(){null!=s&&confirm(t.options.text.areYouSureDeleteThisWorksheet,s.innerText)&&o.deleteWorksheet(s)}}),i.push({type:"line"})),1==t.options.allowExport&&(i.push({icon:"save",title:t.options.text.saveAs+" CSV",shortcut:u+" S",onclick:function(){t.download()}}),i.push({type:"line"})),t.options.about&&i.push({icon:"info",title:t.options.text.about,onclick:function(){!0===t.options.about?alert(jspreadsheet.version(!0)):alert(t.options.about)}}),i},Edit:function(e,t,n){var o,i,s,l,r,c=[];return c.push({icon:"undo",title:t.options.text.undo||"Undo",disabled:!t.options.editable,shortcut:u+" Z",onclick:function(){(jspreadsheet.current||t).undo()}}),c.push({icon:"redo",title:t.options.text.redo||"Redo",disabled:!t.options.editable,shortcut:u+" Y",onclick:function(){(jspreadsheet.current||t).redo()}}),c.push({type:"line"}),c.push({icon:"content_cut",title:t.options.text.cut,shortcut:u+" X",onclick:function(){(jspreadsheet.current||t).copy(!0)}}),c.push({icon:"content_copy",title:t.options.text.copy,shortcut:u+" C",onclick:function(){(jspreadsheet.current||t).copy()}}),navigator&&navigator.clipboard&&navigator.clipboard.readText&&c.push({icon:"content_paste",title:t.options.text.paste,disabled:!t.options.editable,shortcut:u+" V",onclick:function(){t.selectedCell&&navigator.clipboard.readText().then(function(e){e&&jspreadsheet.current.paste(t.selectedCell[0],t.selectedCell[1],e)})}}),null!=t.selectedCell&&(c.push({type:"line"}),o=[],i=[],s=[],r=jspreadsheet.getColumnNameFromId([t.selectedCell[0],t.selectedCell[1]]),l=jspreadsheet.getColumnNameFromId([t.selectedCell[2],t.selectedCell[3]]),l=(r=r.substring(0,r.length-(""+(+t.selectedCell[1]+1)).length))!=(l=l.substring(0,l.length-(""+(+t.selectedCell[3]+1)).length))?`${r} - ${l}`:r,1==t.options.allowInsertColumn&&(o.push({title:t.options.text.insertANewColumnBefore+` (${r})`,onclick:function(){t.insertColumn(1,parseInt(t.selectedCell[0]),1)}}),o.push({title:t.options.text.insertANewColumnAfter+` (${r})`,onclick:function(){t.insertColumn(1,parseInt(t.selectedCell[0]),0)}})),1==t.options.allowDeleteColumn&&i.push({title:t.options.text.deleteSelectedColumns+` (${l})`,disabled:!t.options.editable,onclick:function(){t.deleteColumn(t.getSelectedColumns().length?void 0:parseInt(t.selectedCell[0]))}}),1==t.options.allowRenameColumn&&s.push({title:t.options.text.renameThisColumn+` (${r})`,onclick:function(){t.setHeader(parseInt(t.selectedCell[0]))}}),r=(l=+t.selectedCell[1]+1)!=(r=+t.selectedCell[3]+1)?`${l} - ${r}`:l,1==t.options.allowInsertRow&&(o.push({title:t.options.text.insertANewRowBefore+` (${l})`,onclick:function(){t.insertRow(1,parseInt(t.selectedCell[1]),1)}}),o.push({title:t.options.text.insertANewRowAfter+` (${l})`,onclick:function(){t.insertRow(1,parseInt(t.selectedCell[1]))}})),1==t.options.allowDeleteRow&&i.push({title:t.options.text.deleteSelectedRows+` (${r})`,disabled:!t.options.editable,onclick:function(){t.deleteRow(t.getSelectedRows().length?void 0:parseInt(t.selectedCell[1]))}}),0<o.length&&c.push({title:p.options.text_item_insert,icon:"add",submenu:o}),0<i.length&&c.push({title:p.options.text_item_delete,icon:"remove",submenu:i}),0<s.length&&c.push({title:p.options.text_item_rename,icon:"edit",submenu:s})),c},View:function(e,t,n){var o=[];return e.classList.contains("fullscreen")?o.push({icon:"fullscreen_exit",title:p.options.text_item_fullscreenexit,onclick:function(){r.fullscreen(!1)}}):o.push({icon:"fullscreen",title:p.options.text_item_fullscreenenter,onclick:function(){r.fullscreen(!0)}}),null!=t.selectedCell&&(e=jspreadsheet.getColumnNameFromId([t.selectedCell[0],t.selectedCell[1]]),jspreadsheet.getColumnNameFromId([t.selectedCell[2],t.selectedCell[3]]),e=e.substring(0,e.length-(""+(+t.selectedCell[1]+1)).length),1==t.options.columnSorting&&(o.push({type:"line"}),o.push({title:t.options.text.orderAscending+` (${e})`,onclick:function(){t.orderBy(parseInt(t.selectedCell[0]),0)}}),o.push({title:t.options.text.orderDescending+` (${e})`,onclick:function(){t.orderBy(parseInt(t.selectedCell[0]),1)}}))),1==t.options.filters&&(o.push({type:"line"}),o.push({title:p.options.text_item_resetfilters,onclick:function(){t.resetFilters()}})),o}}};for(t in null==p.options&&(p.options={}),i)p.options.hasOwnProperty(t)&&null!=p.options[t]||(p.options[t]=i[t]),"text_"===t.substring(0,5)&&(n="topmenu_"+t.substring(5,t.length),r.options.text[n]&&(p.options[t]=r.options.text[n]));function s(e,t){return t==e||t!=document&&s(e,t.parentNode)}function l(){for(var e=0;e<p.menus.length;e++){var t=p.menus[e],n=document.createElement("BUTTON");switch(t.name){case"File":n.innerHTML=p.options.text_file;break;case"Edit":n.innerHTML=p.options.text_edit;break;case"View":n.innerHTML=p.options.text_view;break;default:n.innerHTML=t.name}n.addEventListener("click",function(s,l){return function(e){if(d&&this==a)m();else{d=!0,function(e){null!=a&&h(a);e.classList.add("active"),a=e}(this);var t,n,o=e.target.getBoundingClientRect(),o={x:o.left,y:o.top+o.height};for(n in t="function"==typeof s?s(r.el,r,this):s.slice(),r.plugins){var i=r.plugins[n];i.topMenu&&"function"==typeof i.topMenu&&(t=i.topMenu(l,t,this,u))}c.open(o,t),e.preventDefault(),e.stopPropagation()}}}(t.items,t.name)),n.addEventListener("mouseover",function(e){d&&e.target!=a&&this.dispatchEvent(new Event("click"))}),p.topmenu.append(n)}}function h(e){a==e&&(a=null),null!=e&&(e.classList.remove("active"),c.close())}function m(){c.close(),h(a),d=!1}return p.onevent=function(e){"onload"==e&&(r.worksheet.insertBefore(p.topmenu,r.worksheet.firstChild),(o=document.createElement("DIV")).className="jexcel_contextmenu",c=jSuites.contextmenu(o,{onclick:function(){m()}}),r.el.append(o))},p.contextMenu=function(e,t,n,o,i){return s(p.topmenu,o.target)?[]:i},p.add=function(e,t,n){null!=p.topmenu?(null==t&&(t=[]),null!=n?p.menus.splice(n,0,{name:e,items:t}):p.menus.push({name:e,items:t}),p.refresh()):console.error("Topmenu bar is not loaded")},r.addTopmenu=p.add,p.refresh=function(){p.topmenu.innerHTML="",l()},function(){for(var e in p.options.menus)p.menus.push({name:e,items:p.options.menus[e]})}(),p.topmenu=document.createElement("DIV"),p.topmenu.classList.add("jss-topmenu"),p.topmenu.classList.add("jexcel_object"),l(),document.addEventListener("keydown",function(e){27==e.which&&1==d&&(m(),e.preventDefault(),e.stopPropagation())}),document.addEventListener("click",function(e){!d||s(p.topmenu,e.target)&&e.target!=p.topmenu||(m(),e.preventDefault(),e.stopPropagation())}),p}});
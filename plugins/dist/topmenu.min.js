var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet-pro")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_topmenu=t()}(this,function(){return function(c,e){var r="Ctrl +";/(MacPPC|MacIntel|Mac_PowerPC|Macintosh|Mac OS X)/.test(window.navigator.userAgent)&&(r="âŒ˜ +");var i={};i.options=Object.assign({},e),i.topmenu=null,i.menus=[];var t,n,o=null,u=null,p=null,a=!1,s={text_file:"File",text_edit:"Edit",text_view:"View",menus:{File:function(e,t,n){var o,s=[],i=e.querySelector(".jtabs-selected"),l=Array.isArray(e.jspreadsheet)?e.jspreadsheet.length:1;return 1==(o=1==l?t:e.jspreadsheet[0]).options.tabs&&(s.push({icon:"tab",disabled:!t.options.editable,title:"New worksheet",onclick:function(){t.createWorksheet()}}),1==o.options.allowRenameWorksheet&&s.push({icon:"edit",disabled:!t.options.editable,title:t.options.text.renameThisWorksheet+` (${i.innerText})`,onclick:function(){var e;null==i||(e=prompt(t.options.text.renameThisWorksheet,i.innerText))&&o.renameWorksheet(i,e)}}),1==o.options.allowDeleteWorksheet&&1<l&&s.push({icon:"tab_unselected",disabled:!t.options.editable,title:t.options.text.deleteThisWorksheet+` (${i.innerText})`,onclick:function(){null!=i&&confirm(t.options.text.areYouSureDeleteThisWorksheet,i.innerText)&&o.deleteWorksheet(i)}}),s.push({type:"line"})),1==t.options.allowExport&&(s.push({icon:"save",title:t.options.text.saveAs+" CSV",shortcut:r+" S",onclick:function(){t.download()}}),s.push({type:"line"})),t.options.about&&s.push({icon:"info",title:t.options.text.about,onclick:function(){!0===t.options.about?alert(jspreadsheet.version(!0)):alert(t.options.about)}}),s},Edit:function(e,t,n){var o,s,i=[];return i.push({icon:"undo",title:t.options.text.undo||"Undo",disabled:!t.options.editable,shortcut:r+" Z",onclick:function(){(jspreadsheet.current||t).undo()}}),i.push({icon:"redo",title:t.options.text.redo||"Redo",disabled:!t.options.editable,shortcut:r+" Y",onclick:function(){(jspreadsheet.current||t).redo()}}),i.push({type:"line"}),i.push({icon:"content_cut",title:t.options.text.cut,shortcut:r+" X",onclick:function(){(jspreadsheet.current||t).copy(!0)}}),i.push({icon:"content_copy",title:t.options.text.copy,shortcut:r+" C",onclick:function(){(jspreadsheet.current||t).copy()}}),navigator&&navigator.clipboard&&navigator.clipboard.readText&&i.push({icon:"content_paste",title:t.options.text.paste,disabled:!t.options.editable,shortcut:r+" V",onclick:function(){t.selectedCell&&navigator.clipboard.readText().then(function(e){e&&jspreadsheet.current.paste(t.selectedCell[0],t.selectedCell[1],e)})}}),i.push({type:"line"}),null!=t.selectedCell&&(s=jspreadsheet.getColumnNameFromId([t.selectedCell[0],t.selectedCell[1]]),o=jspreadsheet.getColumnNameFromId([t.selectedCell[2],t.selectedCell[3]]),o=(s=s.substring(0,s.length-(""+(+t.selectedCell[1]+1)).length))!=(o=o.substring(0,o.length-(""+(+t.selectedCell[3]+1)).length))?`${s} - ${o}`:s,1==t.options.allowInsertColumn&&(i.push({title:t.options.text.insertANewColumnBefore+` (${s})`,onclick:function(){t.insertColumn(1,parseInt(t.selectedCell[0]),1)}}),i.push({title:t.options.text.insertANewColumnAfter+` (${s})`,onclick:function(){t.insertColumn(1,parseInt(t.selectedCell[0]),0)}})),1==t.options.allowDeleteColumn&&i.push({title:t.options.text.deleteSelectedColumns+` (${o})`,disabled:!t.options.editable,onclick:function(){t.deleteColumn(t.getSelectedColumns().length?void 0:parseInt(t.selectedCell[0]))}}),1==t.options.allowRenameColumn&&i.push({title:t.options.text.renameThisColumn+` (${s})`,onclick:function(){t.setHeader(parseInt(t.selectedCell[0]))}}),i.push({type:"line"}),s=(o=+t.selectedCell[1]+1)!=(s=+t.selectedCell[3]+1)?`${o} - ${s}`:o,1==t.options.allowInsertRow&&(i.push({title:t.options.text.insertANewRowBefore+` (${o})`,onclick:function(){t.insertRow(1,parseInt(t.selectedCell[1]),1)}}),i.push({title:t.options.text.insertANewRowAfter+` (${o})`,onclick:function(){t.insertRow(1,parseInt(t.selectedCell[1]))}})),1==t.options.allowDeleteRow&&i.push({title:t.options.text.deleteSelectedRows+` (${s})`,disabled:!t.options.editable,onclick:function(){t.deleteRow(t.getSelectedRows().length?void 0:parseInt(t.selectedCell[1]))}})),i},View:function(e,t,n){var o=[];return e.classList.contains("fullscreen")?o.push({icon:"fullscreen_exit",title:"Exit fullscreen",onclick:function(){c.fullscreen(!1)}}):o.push({icon:"fullscreen",title:"Enter fullscreen",onclick:function(){c.fullscreen(!0)}}),null!=t.selectedCell&&(e=jspreadsheet.getColumnNameFromId([t.selectedCell[0],t.selectedCell[1]]),jspreadsheet.getColumnNameFromId([t.selectedCell[2],t.selectedCell[3]]),e=e.substring(0,e.length-(""+(+t.selectedCell[1]+1)).length),1==t.options.columnSorting&&(o.push({type:"line"}),o.push({title:t.options.text.orderAscending+` (${e})`,onclick:function(){t.orderBy(parseInt(t.selectedCell[0]),0)}}),o.push({title:t.options.text.orderDescending+` (${e})`,onclick:function(){t.orderBy(parseInt(t.selectedCell[0]),1)}}))),1==t.options.filters&&(o.push({type:"line"}),o.push({title:"Reset filter(s)",onclick:function(){t.resetFilters()}})),o}}};for(t in null==i.options&&(i.options={}),s)i.options.hasOwnProperty(t)&&null!=i.options[t]||(i.options[t]=s[t]),"text_"===t.substring(0,5)&&(n="topmenu_"+t.substring(5,t.length),c.options.text[n]&&(i.options[t]=c.options.text[n]));function l(e,t){return t==e||t!=document&&l(e,t.parentNode)}function d(){for(var e=0;e<i.menus.length;e++){var t=i.menus[e],n=document.createElement("BUTTON");switch(t.name){case"File":n.innerHTML=i.options.text_file;break;case"Edit":n.innerHTML=i.options.text_edit;break;case"View":n.innerHTML=i.options.text_view;break;default:n.innerHTML=t.name}n.addEventListener("click",function(i,l){return function(e){if(a&&this==p)f();else{a=!0,function(e){null!=p&&h(p);e.classList.add("active"),p=e}(this);var t,n,o=e.target.getBoundingClientRect(),o={x:o.left,y:o.top+o.height};for(n in t="function"==typeof i?i(c.el,c,this):i.slice(),c.plugins){var s=c.plugins[n];s.topMenu&&"function"==typeof s.topMenu&&(t=s.topMenu(l,t,this,r))}u.open(o,t),e.preventDefault(),e.stopPropagation()}}}(t.items,t.name)),n.addEventListener("mouseover",function(e){a&&e.target!=p&&this.dispatchEvent(new Event("click"))}),i.topmenu.append(n)}}function h(e){p==e&&(p=null),null!=e&&(e.classList.remove("active"),u.close())}function f(){u.close(),h(p),a=!1}return i.onevent=function(e){"onload"==e&&(c.worksheet.insertBefore(i.topmenu,c.worksheet.firstChild),(o=document.createElement("DIV")).className="jexcel_contextmenu",u=jSuites.contextmenu(o,{onclick:function(){f()}}),c.el.append(o))},i.contextMenu=function(e,t,n,o,s){return l(i.topmenu,o.target)?[]:s},i.add=function(e,t,n){null!=i.topmenu?(null==t&&(t=[]),null!=n?i.menus.splice(n,0,{name:e,items:t}):i.menus.push({name:e,items:t}),i.refresh()):console.error("Topmenu bar is not loaded")},c.addTopmenu=i.add,i.refresh=function(){i.topmenu.innerHTML="",d()},function(){for(var e in i.options.menus)i.menus.push({name:e,items:i.options.menus[e]})}(),i.topmenu=document.createElement("DIV"),i.topmenu.classList.add("jss-topmenu"),i.topmenu.classList.add("jexcel_object"),d(),document.addEventListener("keydown",function(e){27==e.which&&1==a&&(f(),e.preventDefault(),e.stopPropagation())}),document.addEventListener("click",function(e){!a||l(i.topmenu,e.target)&&e.target!=i.topmenu||(f(),e.preventDefault(),e.stopPropagation())}),i}});
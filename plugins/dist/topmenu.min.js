var jSuites,jspreadsheet;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet-pro")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_topmenu=t()}(this,function(){return function(r,e){var c="Ctrl +";/(MacPPC|MacIntel|Mac_PowerPC|Macintosh|Mac OS X)/.test(window.navigator.userAgent)&&(c="âŒ˜ +");var o={};o.options=Object.assign({},e),o.topmenu=null,o.menus=[];var t,n,s=null,u=null,p=null,a=!1,i={text_file:"File",text_edit:"Edit",text_view:"View",menus:{File:function(e,t,n){var o,s=[],i=e.querySelector(".jtabs-selected"),l=Array.isArray(e.jspreadsheet)?e.jspreadsheet.length:1;return 1==(o=1==l?t:e.jspreadsheet[0]).options.tabs&&(s.push({icon:"tab",disabled:!t.options.editable,title:"New worksheet",onclick:function(){t.createWorksheet()}}),1==o.options.allowRenameWorksheet&&s.push({icon:"edit",disabled:!t.options.editable,title:t.options.text.renameThisWorksheet+` (${i.innerText})`,onclick:function(){var e;null==i||(e=prompt(t.options.text.renameThisWorksheet,i.innerText))&&o.renameWorksheet(i,e)}}),1==o.options.allowDeleteWorksheet&&1<l&&s.push({icon:"tab_unselected",disabled:!t.options.editable,title:t.options.text.deleteThisWorksheet+` (${i.innerText})`,onclick:function(){null!=i&&confirm(t.options.text.areYouSureDeleteThisWorksheet,i.innerText)&&o.deleteWorksheet(i)}}),s.push({type:"line"})),1==t.options.allowExport&&(s.push({icon:"save",title:t.options.text.saveAs+" CSV",shortcut:c+" S",onclick:function(){t.download()}}),s.push({type:"line"})),t.options.about&&s.push({icon:"info",title:t.options.text.about,onclick:function(){!0===t.options.about?alert(jspreadsheet.version(!0)):alert(t.options.about)}}),s},Edit:function(e,t,n){var o,s,i=[];return i.push({icon:"undo",title:t.options.text.undo||"Undo",disabled:!t.options.editable,shortcut:c+" Z",onclick:function(){(jspreadsheet.current||t).undo()}}),i.push({icon:"redo",title:t.options.text.redo||"Redo",disabled:!t.options.editable,shortcut:c+" Y",onclick:function(){(jspreadsheet.current||t).redo()}}),i.push({type:"line"}),i.push({icon:"content_cut",title:t.options.text.cut,shortcut:c+" X",onclick:function(){(jspreadsheet.current||t).copy(!0)}}),i.push({icon:"content_copy",title:t.options.text.copy,shortcut:c+" C",onclick:function(){(jspreadsheet.current||t).copy()}}),navigator&&navigator.clipboard&&navigator.clipboard.readText&&i.push({icon:"content_paste",title:t.options.text.paste,disabled:!t.options.editable,shortcut:c+" V",onclick:function(){t.selectedCell&&navigator.clipboard.readText().then(function(e){e&&jspreadsheet.current.paste(t.selectedCell[0],t.selectedCell[1],e)})}}),i.push({type:"line"}),null!=t.selectedCell&&(s=jspreadsheet.getColumnNameFromId([t.selectedCell[0],t.selectedCell[1]]),o=jspreadsheet.getColumnNameFromId([t.selectedCell[2],t.selectedCell[3]]),o=(s=s.substring(0,s.length-(""+t.selectedCell[1]).length))!=(o=o.substring(0,o.length-(""+t.selectedCell[3]).length))?`${s} - ${o}`:s,1==t.options.allowInsertColumn&&(i.push({title:t.options.text.insertANewColumnBefore+` (${s})`,onclick:function(){t.insertColumn(1,parseInt(t.selectedCell[0]),1)}}),i.push({title:t.options.text.insertANewColumnAfter+` (${s})`,onclick:function(){t.insertColumn(1,parseInt(t.selectedCell[0]),0)}})),1==t.options.allowDeleteColumn&&i.push({title:t.options.text.deleteSelectedColumns+` (${o})`,disabled:!t.options.editable,onclick:function(){t.deleteColumn(t.getSelectedColumns().length?void 0:parseInt(t.selectedCell[0]))}}),1==t.options.allowRenameColumn&&i.push({title:t.options.text.renameThisColumn+` (${s})`,onclick:function(){t.setHeader(parseInt(t.selectedCell[0]))}}),i.push({type:"line"}),s=(o=+t.selectedCell[1]+1)!=(s=+t.selectedCell[3]+1)?`${o} - ${s}`:o,1==t.options.allowInsertRow&&(i.push({title:t.options.text.insertANewRowBefore+` (${o})`,onclick:function(){t.insertRow(1,parseInt(t.selectedCell[1]),1)}}),i.push({title:t.options.text.insertANewRowAfter+` (${o})`,onclick:function(){t.insertRow(1,parseInt(t.selectedCell[1]))}})),1==t.options.allowDeleteRow&&i.push({title:t.options.text.deleteSelectedRows+` (${s})`,disabled:!t.options.editable,onclick:function(){t.deleteRow(t.getSelectedRows().length?void 0:parseInt(t.selectedCell[1]))}})),i},View:function(e,t,n){var o=[];return e.classList.contains("fullscreen")?o.push({icon:"fullscreen_exit",title:"Exit fullscreen",onclick:function(){r.fullscreen(!1)}}):o.push({icon:"fullscreen",title:"Enter fullscreen",onclick:function(){r.fullscreen(!0)}}),null!=t.selectedCell&&(e=jspreadsheet.getColumnNameFromId([t.selectedCell[0],t.selectedCell[1]]),jspreadsheet.getColumnNameFromId([t.selectedCell[2],t.selectedCell[3]]),e=e.substring(0,e.length-(""+t.selectedCell[1]).length),1==t.options.columnSorting&&(o.push({type:"line"}),o.push({title:t.options.text.orderAscending+` (${e})`,onclick:function(){t.orderBy(parseInt(t.selectedCell[0]),0)}}),o.push({title:t.options.text.orderDescending+` (${e})`,onclick:function(){t.orderBy(parseInt(t.selectedCell[0]),1)}}))),1==t.options.filters&&(o.push({type:"line"}),o.push({title:"Reset filter(s)",onclick:function(){t.resetFilters()}})),o}}};for(t in null==o.options&&(o.options={}),i)o.options.hasOwnProperty(t)&&null!=o.options[t]||(o.options[t]=i[t]),"text_"===t.substring(0,5)&&(n="topmenu_"+t.substring(5,t.length),r.options.text[n]&&(o.options[t]=r.options.text[n]));function l(){for(var e=0;e<o.menus.length;e++){var t=o.menus[e],n=document.createElement("BUTTON");switch(t.name){case"File":n.innerHTML=o.options.text_file;break;case"Edit":n.innerHTML=o.options.text_edit;break;case"View":n.innerHTML=o.options.text_view;break;default:n.innerHTML=t.name}n.addEventListener("click",function(i,l){return function(e){if(a&&this==p)h();else{a=!0,function(e){null!=p&&d(p);e.classList.add("active"),p=e}(this);var t,n,o=e.target.getBoundingClientRect(),o={x:o.left,y:o.top+o.height};for(n in t="function"==typeof i?i(r.el,r,this):i.slice(),r.plugins){var s=r.plugins[n];s.topMenu&&"function"==typeof s.topMenu&&(t=s.topMenu(l,t,this,c))}u.open(o,t),e.preventDefault(),e.stopPropagation()}}}(t.items,t.name)),n.addEventListener("mouseover",function(e){a&&e.target!=p&&this.dispatchEvent(new Event("click"))}),o.topmenu.append(n)}}function d(e){p==e&&(p=null),null!=e&&(e.classList.remove("active"),u.close())}function h(){u.close(),d(p),a=!1}return o.onevent=function(e){"onload"==e&&(r.worksheet.insertBefore(o.topmenu,r.worksheet.firstChild),(s=document.createElement("DIV")).className="jexcel_contextmenu",u=jSuites.contextmenu(s,{onclick:function(){h()}}),r.el.append(s))},o.add=function(e,t,n){null!=o.topmenu?(null==t&&(t=[]),null!=n?o.menus.splice(n,0,{name:e,items:t}):o.menus.push({name:e,items:t}),o.refresh()):console.error("Topmenu bar is not loaded")},r.addTopmenu=o.add,o.refresh=function(){o.topmenu.innerHTML="",l()},function(){for(var e in o.options.menus)o.menus.push({name:e,items:o.options.menus[e]})}(),o.topmenu=document.createElement("DIV"),o.topmenu.classList.add("jss-topmenu"),o.topmenu.classList.add("jexcel_object"),l(),document.addEventListener("keydown",function(e){27==e.which&&1==a&&(h(),e.preventDefault(),e.stopPropagation())}),document.addEventListener("click",function(e){!a||function e(t,n){if(n==t)return!0;if(n==document)return!1;return e(t,n.parentNode)}(o.topmenu,e.target)&&e.target!=o.topmenu||(h(),e.preventDefault(),e.stopPropagation())}),o}});
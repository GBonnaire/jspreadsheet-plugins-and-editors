var jSuites;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_persistanceFlag=t(),e.jexcel_persistanceFlag=e.jss_persistanceFlag}(this,function(){return function(o,e){var r={},s=null,c=null,a=null,n=null,i=0,t=0;r.options=Object.assign({},e);var l,u,p={showText:!0,showOnlyTime:!1,icon_error:"error",text_error:"Not updated",icon_success:"check_circle",text_success:"Updated {date}",icon_progress:"cached",css_progress:"",text_progress:"Updating",dateFormat:{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};for(l in null==r.options&&(r.options={}),p)r.options.hasOwnProperty(l)&&null!=r.options[l]||(r.options[l]=p[l]),"text_"===l.substring(0,5)&&(u="flagpersistance_"+l.substring(5,l.length),o.options.text[u]&&(r.options[l]=o.options.text[u]));function d(){i<=0?(t=0,n&&(jSuites.notification.isVisible=n)):(5<++t&&(console.error("TimeOut Reset",i),i=0,r.setSuccess()),setTimeout(d,1e3))}return r.onevent=function(e){var t;"onload"==e?o.options.persistance&&function(e){(s=document.createElement("div")).classList.add("jtoolbar-item"),s.classList.add("jexcel-flagPersistance"),r.options.showText&&(c=document.createElement("span"),s.appendChild(c));(a=document.createElement("i")).classList.add("material-icons"),a.style.cssText="display:inline-block",s.appendChild(a),e.toolbar.children[0].appendChild(s)}(o):"onbeforesave"==e&&o.options.toolbar?(i<0&&(i=0),n=n||jSuites.notification.isVisible,0==i&&(jSuites.notification.isVisible=function(){return!0}),i++,r.setInProgress()):"onblur"==e&&o.options.toolbar?0==i?d():setTimeout(d,1e3):"onsave"==e&&o.options.toolbar&&((t=arguments[4]).success?--i<=0&&r.setSuccess():(i=0,r.setError(),console.error(t)))},r.change=function(e,t,o,s){var n,i;-1!=t.indexOf("{date}")&&(n=new Date,i=r.options.showOnlyTime?n.toLocaleTimeString(void 0):n.toLocaleDateString(void 0,r.options.dateFormat),t=t.replace("{date}",i)),-1!=t.indexOf("{time}")&&(i=(n=new Date).toLocaleTimeString(void 0),t=t.replace("{time}",i)),a&&(a.innerHTML=e,a.style.color=s||"inherit",r.options.css_progress&&(!0===o?a.classList.add(r.options.css_progress):a.classList.remove(r.options.css_progress))),c&&(c.innerHTML=t)},r.setInProgress=function(){r.change(r.options.icon_progress,r.options.text_progress,!0)},r.setSuccess=function(){r.change(r.options.icon_success,r.options.text_success,!1,"green")},r.setError=function(){r.change(r.options.icon_error,r.options.text_error,!1,"red")},r}});
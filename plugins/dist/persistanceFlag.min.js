var jSuites;jSuites||"function"!=typeof require||(jSuites=require("jsuites")),function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):e.jss_persistanceFlag=o()}(this,function(){return function(t,e){var r={},s=null,c=null,a=null,n=null,i=0,o=0;r.options=Object.assign({},e);var l,u,p={showText:!0,showOnlyTime:!1,icon_error:"error",text_error:"Not updated",icon_success:"check_circle",text_success:"Updated {date}",icon_progress:"cached",css_progress:"",text_progress:"Updating",dateFormat:{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};for(l in null==r.options&&(r.options={}),p)r.options.hasOwnProperty(l)&&null!=r.options[l]||(r.options[l]=p[l]),"text_"===l.substring(0,5)&&(u="flagpersistance_"+l.substring(5,l.length),t.options.text[u]&&(r.options[l]=t.options.text[u]));function d(){i<=0?(o=0,n&&(jSuites.notification.isVisible=n)):(5<++o&&(console.error("TimeOut Reset",i),i=0,r.setSuccess()),setTimeout(d,1e3))}return r.onevent=function(e){var o;"onload"==e?t.options.persistance&&function(e){(s=document.createElement("div")).classList.add("jtoolbar-item"),s.classList.add("jexcel-flagPersistance"),r.options.showText&&(c=document.createElement("span"),s.appendChild(c));(a=document.createElement("i")).classList.add("material-icons"),a.style.cssText="display:inline-block",s.appendChild(a),e.toolbar.children[0].appendChild(s)}(t):"onbeforesave"==e&&t.options.toolbar?(i<0&&(i=0),n=n||jSuites.notification.isVisible,0==i&&(jSuites.notification.isVisible=function(){return!0}),i++,r.setInProgress()):"onblur"==e&&t.options.toolbar?0==i?d():setTimeout(d,1e3):"onsave"==e&&t.options.toolbar&&((o=arguments[4]).success?--i<=0&&r.setSuccess():(i=0,r.setError(),console.error(o)))},r.change=function(e,o,t,s){var n,i;-1!=o.indexOf("{date}")&&(n=new Date,i=r.options.showOnlyTime?n.toLocaleTimeString(void 0):n.toLocaleDateString(void 0,r.options.dateFormat),o=o.replace("{date}",i)),-1!=o.indexOf("{time}")&&(i=(n=new Date).toLocaleTimeString(void 0),o=o.replace("{time}",i)),a&&(a.innerHTML=e,a.style.color=s||"inherit",r.options.css_progress&&(!0===t?a.classList.add(r.options.css_progress):a.classList.remove(r.options.css_progress))),c&&(c.innerHTML=o)},r.setInProgress=function(){r.change(r.options.icon_progress,r.options.text_progress,!0)},r.setSuccess=function(){r.change(r.options.icon_success,r.options.text_success,!1,"green")},r.setError=function(){r.change(r.options.icon_error,r.options.text_error,!1,"red")},r}}),window.jexcel_persistanceFlag=jss_persistanceFlag;
var jspreadsheet;jspreadsheet||"function"!=typeof require||(jspreadsheet=require("jspreadsheet-pro")),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jss_statusbar=t(),e.jexcel_statusbar=e.jss_statusbar}(this,function(){return function(l,e){var u={},d=null,a=null,p=null;u.options=Object.assign({},e);var t,n,s={showAddRowButton:!0,formulas:{Range:"{range}",SUM:"=SUM({range})",MAX:"=MAX({range})",MIN:"=MIN({range})"},text_AddRowButton:"Add {*} row(s)"};for(t in null==u.options&&(u.options={}),s)u.options.hasOwnProperty(t)&&null!=u.options[t]||(u.options[t]=s[t]),"text_"===t.substring(0,5)&&(n="statusbar_"+t.substring(5,t.length),l.options.text[n]&&(u.options[t]=l.options.text[n]));function c(e,t){for(var n in t)e=e.replace(new RegExp("{[ ]?"+n+"[ ]?}","gi"),t[n]);return e}return u.onevent=function(e){"onload"==e?u.createStatusbar(l.content):"onselection"==e?(d=[arguments[2],arguments[3],arguments[4],arguments[5]],u.generateInformation()):"onblur"==e&&p&&(p.innerHTML="")},u.createStatusbar=function(e){(a=document.createElement("div")).classList.add("jexcel_statusbar");var t=u.options.text_AddRowButton.split("{*}"),n=document.createElement("div");n.classList.add("jexcel_statusbar_addrows"),u.options.showAddRowButton&&0!=l.options.allowInsertRow||(n.style.display="none");var s=document.createElement("input");s.setAttribute("type","number"),s.setAttribute("min","1"),s.setAttribute("step","1"),s.value=1;var r=document.createElement("button");r.innerHTML=t[0],r.onclick=function(e){jspreadsheet.current.insertRow(parseInt(s.value))};var o=document.createElement("span");o.innerHTML=t[1],n.appendChild(r),n.appendChild(s),n.appendChild(o),a.appendChild(n),(p=document.createElement("div")).classList.add("jexcel_statusbar_information"),a.appendChild(p),e.appendChild(a)},u.generateInformation=function(){var e="",t=""==l.getData(!0).join("");null==d&&(d=l.selectedCell);var n,s=jspreadsheet.getColumnNameFromId([d[0],d[1]]);n=d[0]!=d[2]||d[1]!=d[3]?jspreadsheet.getColumnNameFromId([d[2],d[3]]):"";var r,o={};for(r in o.range=s+(""!=n?":"+n:""),o.cells=function(e){var t=[],n=e.split(":");if(!n[1])return"["+n[0]+"]";var s,r,o,a,e=jspreadsheet.getIdFromColumnName(n[0],!0),n=jspreadsheet.getIdFromColumnName(n[1],!0);r=e[0]<=n[0]?(s=e[0],n[0]):(s=n[0],e[0]),a=e[1]<=n[1]?(o=e[1],n[1]):(o=n[1],e[1]);for(var i=o;i<=a;i++)for(var u=s;u<=r;u++)null!=l.results&&-1==l.results.indexOf(i)||t.push(jspreadsheet.getColumnNameFromId([u,i]));return"["+t.join(",")+"]"}(o.range),o.x1=parseInt(d[0]),o.y1=parseInt(d[1]),o.x2=parseInt(d[2]),o.y2=parseInt(d[3]),u.options.formulas){var a,i=u.options.formulas[r];"="==i.substr(0,1)?t||(""!=e&&(e+="<span class='divisor'></span>"),null!==(a=l.executeFormula(c(i,o)))&&(e+=r+" : "+a)):(""!=e&&(e+="<span class='divisor'></span>"),e+=r+" : "+c(i,o))}d=null,p.innerHTML=e},u}});